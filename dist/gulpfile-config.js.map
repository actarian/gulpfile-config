{"version":3,"file":"src/gulpfile-config.js","sources":["../src/logger/logger.js","../src/watch/watch.js","../src/config/json.js","../src/config/config.js","../src/tfs/tfs.js","../src/compile/sass.js","../src/compile/mjml.js","../src/compile/rollup.js","../src/compile/typescript.js","../src/compile/compile.js","../src/bundle/bundle.js","../src/copy/copy.js","../src/serve/serve.js","../src/gulpfile-config.js"],"sourcesContent":["const ansyGray = require('ansi-gray');\r\nconst colorSupport = require('color-support');\r\nconst consoleConsole = require('console').Console;\r\nconst parseNodeVersion = require('parse-node-version');\r\nconst timeStamp = require('time-stamp');\r\n\r\nconst nodeVersion = parseNodeVersion(process.version);\r\n\r\nconst colorDetectionOptions = {\r\n\t// If on Windows, ignore the isTTY check\r\n\t// This is due to AppVeyor (and thus probably common Windows platforms?) failing the check\r\n\t// TODO: If this is too broad, we can reduce it to an APPVEYOR env check\r\n\tignoreTTY: (process.platform === 'win32'),\r\n};\r\n\r\n// Needed to add this because node 10 decided to start coloring log output randomly\r\nlet console;\r\nif (nodeVersion.major >= 10) {\r\n\t// Node 10 also changed the way this is constructed\r\n\tconsole = new consoleConsole({\r\n\t\tstdout: process.stdout,\r\n\t\tstderr: process.stderr,\r\n\t\tcolorMode: false,\r\n\t});\r\n} else {\r\n\tconsole = new consoleConsole(process.stdout, process.stderr);\r\n}\r\n\r\nconst palette = {\r\n\tReset: '\\x1b[0m',\r\n\tBright: '\\x1b[1m',\r\n\tDim: '\\x1b[2m',\r\n\tUnderscore: '\\x1b[4m',\r\n\tBlink: '\\x1b[5m',\r\n\tReverse: '\\x1b[7m',\r\n\tHidden: '\\x1b[8m',\r\n\t//\r\n\tFgBlack: '\\x1b[30m',\r\n\tFgRed: '\\x1b[31m',\r\n\tFgGreen: '\\x1b[32m',\r\n\tFgYellow: '\\x1b[33m',\r\n\tFgBlue: '\\x1b[34m',\r\n\tFgMagenta: '\\x1b[35m',\r\n\tFgCyan: '\\x1b[36m',\r\n\tFgWhite: '\\x1b[37m',\r\n\t//\r\n\tBgBlack: '\\x1b[40m',\r\n\tBgRed: '\\x1b[41m',\r\n\tBgGreen: '\\x1b[42m',\r\n\tBgYellow: '\\x1b[43m',\r\n\tBgBlue: '\\x1b[44m',\r\n\tBgMagenta: '\\x1b[45m',\r\n\tBgCyan: '\\x1b[46m',\r\n\tBgWhite: '\\x1b[47m',\r\n};\r\n\r\nconst colors = [palette.FgWhite, palette.FgCyan, palette.FgGreen, palette.FgYellow, palette.FgMagenta, palette.FgBlue];\r\n\r\nfunction hasFlag(flag) {\r\n\treturn (process.argv.indexOf('--' + flag) !== -1);\r\n}\r\n\r\nfunction addColor(str) {\r\n\tif (hasFlag('no-color')) {\r\n\t\treturn str;\r\n\t}\r\n\r\n\tif (hasFlag('color')) {\r\n\t\treturn ansyGray(str);\r\n\t}\r\n\r\n\tif (colorSupport(colorDetectionOptions)) {\r\n\t\treturn ansyGray(str);\r\n\t}\r\n\r\n\treturn str;\r\n}\r\n\r\nfunction getTimestamp() {\r\n\treturn '[' + addColor(timeStamp('HH:mm:ss')) + ']';\r\n}\r\n\r\nfunction getLogMessage(items) {\r\n\tlet a = Array.from(items);\r\n\ta = [].concat.apply([], (a.map((x, i) => [colors[i % colors.length], x])));\r\n\ta.push(palette.Reset);\r\n\treturn a;\r\n}\r\n\r\nfunction getErrorMessage(items) {\r\n\tlet a = Array.from(items);\r\n\ta = [].concat.apply([], (a.map((x, i) => [palette.FgRed, x])));\r\n\ta.push(palette.Reset);\r\n\treturn a;\r\n}\r\n\r\nfunction log() {\r\n\tconst time = getTimestamp();\r\n\tprocess.stdout.write(time + ' ');\r\n\tconsole.log.apply(console, getLogMessage(arguments));\r\n\treturn this;\r\n}\r\n\r\nfunction info() {\r\n\tconst time = getTimestamp();\r\n\tprocess.stdout.write(time + ' ');\r\n\tconsole.info.apply(console, getLogMessage(arguments));\r\n\treturn this;\r\n}\r\n\r\nfunction dir() {\r\n\tconst time = getTimestamp();\r\n\tprocess.stdout.write(time + ' ');\r\n\tconsole.dir.apply(console, getLogMessage(arguments));\r\n\treturn this;\r\n}\r\n\r\nfunction warn() {\r\n\tconst time = getTimestamp();\r\n\tprocess.stderr.write(time + ' ');\r\n\tconsole.warn.apply(console, getLogMessage(arguments));\r\n\treturn this;\r\n}\r\n\r\nfunction error() {\r\n\tconst time = getTimestamp();\r\n\tprocess.stderr.write(time + ' ');\r\n\tconsole.error.apply(console, getErrorMessage(arguments));\r\n\treturn this;\r\n}\r\n\r\nmodule.exports = log;\r\nmodule.exports.info = info;\r\nmodule.exports.dir = dir;\r\nmodule.exports.warn = warn;\r\nmodule.exports.error = error;\r\n","const path = require('path');\r\nconst minimatch = require(\"minimatch\");\r\nconst { watch } = require('gulp');\r\n\r\nconst log = require('../logger/logger');\r\nconst entries = {};\r\nconst cwd = process.cwd();\r\n\r\nlet watcher;\r\n\r\nfunction watchEntries(callback) {\r\n\tif (watcher && typeof watcher.close === 'function') {\r\n\t\twatcher.close();\r\n\t}\r\n\twatcher = watch(['**/*.*', '!node_modules/**/*.*']).on('change', (path_) => {\r\n\t\tconst matchedEntries = Object.keys(entries).filter(key => {\r\n\t\t\tconst imports = entries[key];\r\n\t\t\tif (isGlob(key)) {\r\n\t\t\t\treturn isExt(path_, imports) && sameRoot(path_, key);\r\n\t\t\t} else if (isPath(imports)) {\r\n\t\t\t\treturn matchPaths(key, path_);\r\n\t\t\t} else {\r\n\t\t\t\tconst found = imports.find(i => {\r\n\t\t\t\t\t// console.log(i, path_);\r\n\t\t\t\t\treturn matchPaths(i, path_);\r\n\t\t\t\t}) || matchPaths(key, path_);\r\n\t\t\t\treturn found;\r\n\t\t\t}\r\n\t\t});\r\n\t\tif (matchedEntries.length) {\r\n\t\t\tif (typeof callback === 'function') {\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tmatchedEntries.forEach(entry => callback(path_, entry));\r\n\t\t\t\t}, 1);\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n}\r\n\r\nfunction setEntry(entry, imports) {\r\n\t// console.log(entry, imports);\r\n\tentry = entry.replace(cwd, '');\r\n\tif (typeof imports === 'string') {\r\n\t\t//\r\n\t\tentries[entry] = imports;\r\n\t} else if (imports) {\r\n\t\timports = Array.isArray(imports) ? imports : [imports];\r\n\t\timports = imports.map(x => x.replace(cwd, ''));\r\n\t\tentries[entry] = imports;\r\n\t}\r\n\t// log('watch', entry, imports);\r\n}\r\n\r\nfunction isGlob(path) {\r\n\treturn typeof path === 'string' && path.indexOf('*') !== -1;\r\n}\r\n\r\nfunction isPath(path) {\r\n\treturn typeof path === 'string' && path.indexOf('*') === -1;\r\n}\r\n\r\nfunction isExt(p1, ext) {\r\n\treturn path.extname(p1) === ext;\r\n}\r\n\r\nfunction sameRoot(p1, p2) {\r\n\treturn path.dirname(p1).indexOf(path.dirname(p2)) === 0;\r\n}\r\n\r\nfunction matchPaths(p1, p2) {\r\n\treturn minimatch(p1, p2);\r\n\t// return path.normalize(p1).indexOf(path.normalize(p2)) !== -1;\r\n}\r\n\r\nmodule.exports = {\r\n\twatchEntries,\r\n\tsetEntry,\r\n\tisGlob,\r\n\tisPath,\r\n\tisExt,\r\n\tsameRoot,\r\n\tmatchPaths\r\n};\r\n","const fs = require('fs'),\r\n\tpath = require('path'),\r\n\tprocess = require('process');\r\n\r\nconst log = require('../logger/logger');\r\n\r\nfunction getObject(file, objectDefault = {}, objectOverride = {}) {\r\n\tlet object = extendObject({}, objectDefault);\r\n\tif (fs.existsSync(file)) {\r\n\t\tconst text = fs.readFileSync(file, 'utf8');\r\n\t\tconst objectJson = JSON.parse(stripBom(text));\r\n\t\tobject = extendObject(object, objectJson);\r\n\t} else {\r\n\t\tlog.warn(`missing ${file}`);\r\n\t}\r\n\tobject = extendObject(object, objectOverride);\r\n\treturn object;\r\n}\r\n\r\nfunction stripBom(text) {\r\n\ttext = text.toString();\r\n\tif (text.charCodeAt(0) === 0xFEFF) {\r\n\t\ttext = text.slice(1);\r\n\t}\r\n\treturn text;\r\n}\r\n\r\nfunction extendObject(a, b) {\r\n\tif (typeof a === 'object') {\r\n\t\tfor (let key in b) {\r\n\t\t\tif (typeof a[key] === 'object' && typeof b[key] === 'object') {\r\n\t\t\t\ta[key] = extendObject(a[key], b[key]);\r\n\t\t\t} else {\r\n\t\t\t\ta[key] = b[key];\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn a;\r\n\t} else {\r\n\t\treturn b;\r\n\t}\r\n}\r\n\r\nmodule.exports = {\r\n\tgetObject,\r\n\textend: extendObject,\r\n};\r\n","const fs = require('fs'),\r\n\tpath = require('path'),\r\n\tprocess = require('process');\r\n\r\nconst { watch } = require('gulp');\r\n\r\nconst log = require('../logger/logger');\r\n\r\nconst { getObject, extend } = require('./json');\r\n\r\nconst CONFIG_PATH = './gulpfile-config.json';\r\nconst options = getOptions();\r\nconst target = options.target || 'browser';\r\n\r\nconst service = {\r\n\toptions,\r\n};\r\n\r\nfunction getOptions() {\r\n\tlet key = undefined;\r\n\tconst o = process.argv.reduce((p, c, a) => {\r\n\t\tlet k, v;\r\n\t\tif (c.indexOf('--') === 0) {\r\n\t\t\tk = c.substr(2);\r\n\t\t} else {\r\n\t\t\tv = c;\r\n\t\t}\r\n\t\tif (key) {\r\n\t\t\tp[key] = (v === undefined ? true : v);\r\n\t\t\tkey = undefined;\r\n\t\t}\r\n\t\tkey = k;\r\n\t\treturn p;\r\n\t}, {});\r\n\tif (key) {\r\n\t\to[key] = true;\r\n\t}\r\n\treturn o;\r\n}\r\n\r\nfunction getTarget() {\r\n\treturn {\r\n\t\tcompile: [],\r\n\t\tbundle: [],\r\n\t};\r\n}\r\n\r\nfunction getConfig() {\r\n\tlet configDefault = {\r\n\t\ttargets: {\r\n\t\t\tbrowser: getTarget(),\r\n\t\t\tdist: getTarget()\r\n\t\t},\r\n\t\tserver: {\r\n\t\t\tsrc: './docs',\r\n\t\t\tpath: '/gulpfile-config/',\r\n\t\t\thost: 'localhost',\r\n\t\t\tport: 40900\r\n\t\t},\r\n\t\ttfs: false\r\n\t};\r\n\tconst config = getObject(CONFIG_PATH, configDefault);\r\n\tconfig.target = config.targets[target] || getTarget();\r\n\tservice.target = target;\r\n\tservice.config = config.target;\r\n\tservice.config.server = config.server;\r\n\tservice.config.tfs = config.tfs;\r\n\treturn config;\r\n}\r\n\r\n/*\r\nfunction configWatcher(callback) {\r\n\tconst configWatch = watch(CONFIG_PATH, function config(done) {\r\n\t\t// config = getConfig();\r\n\t\tif (typeof callback === 'function') {\r\n\t\t\treturn callback(done);\r\n\t\t}\r\n\t}).on('change', logWatch);\r\n\treturn [configWatch];\r\n}\r\n\r\nfunction logWatch(path, stats) {\r\n\tlog('Changed', path);\r\n}\r\n*/\r\n\r\nmodule.exports = {\r\n\tCONFIG_PATH,\r\n\tgetConfig: getConfig,\r\n\ttarget: target,\r\n\tservice: service,\r\n};\r\n","const fs = require('fs'),\r\n\tgulpIf = require('gulp-if'),\r\n\ttfs = require('tfs'),\r\n\tthrough2 = require('through2');\r\n\r\nconst log = require('../logger/logger');\r\nconst { service } = require('../config/config');\r\n\r\nfunction tfsCheckout(skip) {\r\n\treturn gulpIf(!skip && service.config.tfs, through2.obj((file, enc, callback) => {\r\n\t\t// console.log('TfsCheckout', file.path);\r\n\t\tif (fs.existsSync(file.path)) {\r\n\t\t\tconst paths = [file.path];\r\n\t\t\tif (fs.existsSync(file.path + '.map')) {\r\n\t\t\t\tpaths.push(file.path + '.map');\r\n\t\t\t}\r\n\t\t\ttfs('checkout', paths, null, (responseError, response) => {\r\n\t\t\t\tcallback(null, file);\r\n\t\t\t\tif (responseError) {\r\n\t\t\t\t\tconsole.error(responseError.error);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tlog('Checkout', file.path, response.message);\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tcallback(null, file);\r\n\t\t}\r\n\t}));\r\n}\r\n\r\nmodule.exports = tfsCheckout;\r\n","const nodeSass = require('node-sass'),\r\n\tpath = require('path'),\r\n\tthrough2 = require('through2'),\r\n\tvinyl = require('vinyl'),\r\n\tvinylSourcemapsApply = require('vinyl-sourcemaps-apply');\r\n\r\nconst log = require('../logger/logger');\r\nconst { service } = require('../config/config');\r\n\r\nconst { setEntry } = require('../watch/watch');\r\n\r\nfunction sass(options, sync) {\r\n\toptions = Object.assign({}, options);\r\n\treturn through2.obj(function(file, enc, callback) { // eslint-disable-line consistent-return\r\n\t\tif (file.isNull()) {\r\n\t\t\treturn callback(null, file);\r\n\t\t}\r\n\t\tif (file.isStream()) {\r\n\t\t\tlog.error('sass', 'streaming not supported');\r\n\t\t\treturn callback(null, file);\r\n\t\t}\r\n\t\tconst input = file.path;\r\n\t\tif (path.basename(file.path).indexOf('_') === 0) {\r\n\t\t\treturn callback();\r\n\t\t}\r\n\t\tif (!file.contents.length) {\r\n\t\t\tfile.path = replaceExtension(file.path, '.css'); // eslint-disable-line no-param-reassign\r\n\t\t\treturn callback(null, file);\r\n\t\t}\r\n\t\toptions.data = file.contents.toString();\r\n\t\t// we set the file path here so that libsass can correctly resolve import paths\r\n\t\toptions.file = file.path;\r\n\t\t// Ensure `indentedSyntax` is true if a `.sass` file\r\n\t\tif (path.extname(file.path) === '.sass') {\r\n\t\t\toptions.indentedSyntax = true;\r\n\t\t}\r\n\t\t// Ensure file's parent directory in the include path\r\n\t\tif (options.includePaths) {\r\n\t\t\tif (typeof options.includePaths === 'string') {\r\n\t\t\t\toptions.includePaths = [options.includePaths];\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\toptions.includePaths = [];\r\n\t\t}\r\n\t\toptions.includePaths.unshift(path.dirname(file.path));\r\n\t\t// Generate Source Maps if plugin source-map present\r\n\t\tif (file.sourceMap) {\r\n\t\t\toptions.sourceMap = file.path;\r\n\t\t\toptions.omitSourceMapUrl = true;\r\n\t\t\toptions.sourceMapContents = true;\r\n\t\t}\r\n\t\tconst filePush = (sassObj) => {\r\n\t\t\tlet sassMap;\r\n\t\t\tlet sassMapFile;\r\n\t\t\tlet sassFileSrc;\r\n\t\t\tlet sassFileSrcPath;\r\n\t\t\tlet sourceFileIndex;\r\n\t\t\t// Build Source Maps!\r\n\t\t\tif (sassObj.map) {\r\n\t\t\t\t// Transform map into JSON\r\n\t\t\t\tsassMap = JSON.parse(sassObj.map.toString());\r\n\t\t\t\t// Grab the stdout and transform it into stdin\r\n\t\t\t\tsassMapFile = sassMap.file.replace(/^stdout$/, 'stdin');\r\n\t\t\t\t// Grab the base file name that's being worked on\r\n\t\t\t\tsassFileSrc = file.relative;\r\n\t\t\t\t// Grab the path portion of the file that's being worked on\r\n\t\t\t\tsassFileSrcPath = path.dirname(sassFileSrc);\r\n\t\t\t\tif (sassFileSrcPath) {\r\n\t\t\t\t\t// Prepend the path to all files in the sources array except the file that's being worked on\r\n\t\t\t\t\tsourceFileIndex = sassMap.sources.indexOf(sassMapFile);\r\n\t\t\t\t\tsassMap.sources = sassMap.sources.map((source, index) => { // eslint-disable-line arrow-body-style\r\n\t\t\t\t\t\treturn index === sourceFileIndex ? source : path.join(sassFileSrcPath, source);\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\t// Remove 'stdin' from souces and replace with filenames!\r\n\t\t\t\tsassMap.sources = sassMap.sources.filter(src => src !== 'stdin' && src);\r\n\t\t\t\t// Replace the map file with the original file name (but new extension)\r\n\t\t\t\tsassMap.file = replaceExtension(sassFileSrc, '.css');\r\n\t\t\t\t// Apply the map\r\n\t\t\t\tvinylSourcemapsApply(file, sassMap);\r\n\t\t\t}\r\n\t\t\tfile.contents = sassObj.css; // eslint-disable-line no-param-reassign\r\n\t\t\tfile.path = replaceExtension(file.path, '.css'); // eslint-disable-line no-param-reassign\r\n\t\t\tcallback(null, file);\r\n\t\t};\r\n\t\tif (sync !== true) {\r\n\t\t\tconst callback = (error, object) => { // eslint-disable-line consistent-return\r\n\t\t\t\tif (error) {\r\n\t\t\t\t\treturn log.error('sass', error);\r\n\t\t\t\t\t// return callback(null, null);\r\n\t\t\t\t}\r\n\t\t\t\tsetEntry(input, object.stats.includedFiles);\r\n\t\t\t\tfilePush(object);\r\n\t\t\t};\r\n\t\t\tnodeSass.render(options, callback);\r\n\t\t} else {\r\n\t\t\ttry {\r\n\t\t\t\tconst object = nodeSass.renderSync(options);\r\n\t\t\t\tsetEntry(input, object.stats.includedFiles);\r\n\t\t\t\tfilePush(object);\r\n\t\t\t} catch (error) {\r\n\t\t\t\treturn log.error('sass', error);\r\n\t\t\t\t// return callback(null, null);\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n}\r\n\r\nsass.sync = (options) => sass(options, true);\r\n\r\nfunction replaceExtension(filePath, ext) {\r\n\tfilePath = path.format({\r\n\t\tdir: path.dirname(filePath),\r\n\t\tname: path.basename(filePath, path.extname(filePath)),\r\n\t\text,\r\n\t});\r\n\treturn filePath;\r\n}\r\n\r\n/*\r\n\r\nconst errorM = (error) => {\r\n\tconst filePath = (error.file === 'stdin' ? file.path : error.file) || file.path;\r\n\tconst relativePath = path.relative(process.cwd(), filePath);\r\n\tconst message = [chalk.underline(relativePath), error.formatted].join('\\n');\r\n\r\n\terror.messageFormatted = message; // eslint-disable-line no-param-reassign\r\n\terror.messageOriginal = error.message; // eslint-disable-line no-param-reassign\r\n\terror.message = stripAnsi(message); // eslint-disable-line no-param-reassign\r\n\terror.relativePath = relativePath; // eslint-disable-line no-param-reassign\r\n\r\n\treturn callback(new pluginError('sass', error));\r\n};\r\n\r\nsass.logError = function logError(error) {\r\n\tconst message = new pluginError('sass', error.messageFormatted).toString();\r\n\tprocess.stderr.write(`${message}\\n`);\r\n\tthis.emit('end');\r\n};\r\n*/\r\n\r\nmodule.exports = {\r\n\tsass\r\n};\r\n","const path = require('path'),\r\n\trollup = require('rollup'),\r\n\trollupPluginMjml = require('rollup-plugin-mjml'),\r\n\tthrough2 = require('through2'),\r\n\tvinyl = require('vinyl');\r\n\r\nconst log = require('../logger/logger');\r\n\r\nconst { setEntry } = require('../watch/watch');\r\n\r\nlet rollupCache = new Map();\r\n\r\nfunction mjml(item) {\r\n\treturn through2.obj(function(file, enc, callback) {\r\n\t\tif (file.isNull()) {\r\n\t\t\treturn callback(null, file);\r\n\t\t}\r\n\t\tif (file.isStream()) {\r\n\t\t\tlog.error('mjml', 'streaming not supported');\r\n\t\t\treturn callback(null, file);\r\n\t\t}\r\n\t\tconst inputOptions = mjmlInput(item, file.path);\r\n\t\tif (inputOptions.cache !== false) {\r\n\t\t\tinputOptions.cache = rollupCache.get(inputOptions.input);\r\n\t\t}\r\n\t\tconst rollupGenerate = (bundle, output, i) => {\r\n\t\t\treturn bundle.generate(output).then(result => {\r\n\t\t\t\tif (!result) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tconst out = result.output.find(x => x.type === 'asset');\r\n\t\t\t\tconst newFilePath = path.format({\r\n\t\t\t\t\tdir: path.dirname(output.file),\r\n\t\t\t\t\tname: path.basename(file.path, path.extname(file.path)),\r\n\t\t\t\t\text: '.html',\r\n\t\t\t\t});\r\n\t\t\t\tlet targetFile;\r\n\t\t\t\tif (i > 0) {\r\n\t\t\t\t\tconst newFile = new vinyl({\r\n\t\t\t\t\t\tcwd: file.cwd,\r\n\t\t\t\t\t\tbase: file.base,\r\n\t\t\t\t\t\tpath: newFilePath,\r\n\t\t\t\t\t\tstat: {\r\n\t\t\t\t\t\t\tisFile: () => true,\r\n\t\t\t\t\t\t\tisDirectory: () => false,\r\n\t\t\t\t\t\t\tisBlockDevice: () => false,\r\n\t\t\t\t\t\t\tisCharacterDevice: () => false,\r\n\t\t\t\t\t\t\tisSymbolicLink: () => false,\r\n\t\t\t\t\t\t\tisFIFO: () => false,\r\n\t\t\t\t\t\t\tisSocket: () => false\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\ttargetFile = newFile;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tfile.path = newFilePath;\r\n\t\t\t\t\ttargetFile = file;\r\n\t\t\t\t}\r\n\t\t\t\ttargetFile.contents = Buffer.from(out.source);\r\n\t\t\t\tif (i > 0) {\r\n\t\t\t\t\tthis.push(targetFile);\r\n\t\t\t\t}\r\n\t\t\t\treturn result;\r\n\t\t\t}).catch(error => {\r\n\t\t\t\tlog.error('mjml', error);\r\n\t\t\t});\r\n\t\t};\r\n\t\trollup.rollup(inputOptions).then(bundle => {\r\n\t\t\t\tconst outputs = mjmlOutput(item);\r\n\t\t\t\tif (inputOptions.cache !== false) {\r\n\t\t\t\t\trollupCache.set(inputOptions.input, bundle);\r\n\t\t\t\t}\r\n\t\t\t\treturn Promise.all(outputs.map((output, i) => rollupGenerate(bundle, output, i)));\r\n\t\t\t})\r\n\t\t\t.then((results) => {\r\n\t\t\t\tresults.forEach(x => {\r\n\t\t\t\t\tconst outputs = x.output;\r\n\t\t\t\t\toutputs.forEach(x => {\r\n\t\t\t\t\t\tsetEntry(inputOptions.input, [inputOptions.input]);\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t\tcallback(null, file);\r\n\t\t\t})\r\n\t\t\t.catch(error => {\r\n\t\t\t\tlog.error('mjml', error);\r\n\t\t\t\tif (inputOptions.cache !== false) {\r\n\t\t\t\t\trollupCache.delete(inputOptions.input);\r\n\t\t\t\t}\r\n\t\t\t\tthrow (error);\r\n\t\t\t});\r\n\t});\r\n}\r\n\r\nfunction mjmlInput(item, path) {\r\n\tconst plugins = [\r\n\t\trollupPluginMjml({\r\n\t\t\tkeepComments: item.minify ? false : true,\r\n\t\t\tminify: item.minify ? true : false,\r\n\t\t\tminifyOptions: item.minify ? {\r\n\t\t\t\tcollapseWhitespace: true,\r\n\t\t\t\tminifyCSS: false,\r\n\t\t\t\tremoveEmptyAttributes: true\r\n\t\t\t} : {},\r\n\t\t\tbeautify: item.minify ? false : true,\r\n\t\t\tvalidationLevel: 'soft',\r\n\t\t\t// validationLevel: item.validationLevel || 'strict',\r\n\t\t}),\r\n\t].filter(x => x);\r\n\tconst input = {\r\n\t\tinput: path,\r\n\t\tplugins: plugins,\r\n\t\tcache: false,\r\n\t};\r\n\treturn input;\r\n}\r\n\r\nfunction mjmlOutput(item) {\r\n\tconst input = item.input;\r\n\tconst output = item.output;\r\n\tconst outputs = Array.isArray(output) ? output : [output];\r\n\tconst default_ = {\r\n\t\tcompact: item.minify || false,\r\n\t};\r\n\treturn outputs.map(x => {\r\n\t\tlet output = Object.assign({}, default_);\r\n\t\tif (typeof x === 'string') {\r\n\t\t\toutput.file = x;\r\n\t\t} else if (typeof x === 'object') {\r\n\t\t\toutput = Object.assign(output, x);\r\n\t\t}\r\n\t\treturn output;\r\n\t});\r\n}\r\n\r\nmodule.exports = {\r\n\tmjml,\r\n\tmjmlInput,\r\n\tmjmlOutput,\r\n};\r\n","const { DEFAULT_EXTENSIONS } = require('@babel/core'),\r\n\tpath = require('path'),\r\n\trollup = require('rollup'),\r\n\trollupPluginBabel = require('@rollup/plugin-babel').babel,\r\n\trollupPluginCommonJs = require('@rollup/plugin-commonjs'),\r\n\trollupPluginSourcemaps = require('rollup-plugin-sourcemaps'),\r\n\trollupPluginLicense = require('rollup-plugin-license'),\r\n\trollupPluginNodeResolve = require('@rollup/plugin-node-resolve'),\r\n\trollupPluginTypescript2 = require('rollup-plugin-typescript2'),\r\n\t// rollupPluginTypescript = require('@rollup/plugin-typescript'),\r\n\tthrough2 = require('through2'),\r\n\ttypescript = require('typescript'),\r\n\tvinyl = require('vinyl'),\r\n\tvinylSourcemapsApply = require('vinyl-sourcemaps-apply');\r\n\r\nconst log = require('../logger/logger');\r\nconst { service } = require('../config/config');\r\n\r\nconst { setEntry } = require('../watch/watch');\r\n\r\n// map object storing rollup cache objects for each input file\r\nlet rollupCache = new Map();\r\n\r\nfunction rollup_(item) {\r\n\treturn through2.obj(function(file, enc, callback) {\r\n\t\tif (file.isNull()) {\r\n\t\t\treturn callback(null, file);\r\n\t\t}\r\n\t\tif (file.isStream()) {\r\n\t\t\tlog.error('rollup', 'streaming not supported');\r\n\t\t\treturn callback(null, file);\r\n\t\t}\r\n\t\tconst inputOptions = rollupInput(item);\r\n\t\t// caching is enabled by default because of the nature of gulp and the watching/recompilatin\r\n\t\t// but can be disabled by setting 'cache' to false\r\n\t\tif (inputOptions.cache !== false) {\r\n\t\t\tinputOptions.cache = rollupCache.get(inputOptions.input);\r\n\t\t}\r\n\t\tconst maps = file.sourceMap !== undefined;\r\n\t\tconst originalCwd = file.cwd;\r\n\t\tconst originalPath = file.path;\r\n\t\tconst rollupGenerate = (bundle, output, i) => {\r\n\t\t\treturn bundle.generate(output).then(result => {\r\n\t\t\t\tif (!result) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tconst newFileName = path.basename(output.file);\r\n\t\t\t\tconst newFilePath = output.file;\r\n\t\t\t\tlet targetFile;\r\n\t\t\t\tif (i > 0) {\r\n\t\t\t\t\tconst newFile = new vinyl({\r\n\t\t\t\t\t\tcwd: file.cwd,\r\n\t\t\t\t\t\tbase: file.base,\r\n\t\t\t\t\t\tpath: newFilePath,\r\n\t\t\t\t\t\tstat: {\r\n\t\t\t\t\t\t\tisFile: () => true,\r\n\t\t\t\t\t\t\tisDirectory: () => false,\r\n\t\t\t\t\t\t\tisBlockDevice: () => false,\r\n\t\t\t\t\t\t\tisCharacterDevice: () => false,\r\n\t\t\t\t\t\t\tisSymbolicLink: () => false,\r\n\t\t\t\t\t\t\tisFIFO: () => false,\r\n\t\t\t\t\t\t\tisSocket: () => false\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\ttargetFile = newFile;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tfile.path = newFilePath;\r\n\t\t\t\t\ttargetFile = file;\r\n\t\t\t\t}\r\n\t\t\t\tconst generated = result.output[0];\r\n\t\t\t\t// Pass sourcemap content and metadata to gulp-sourcemaps plugin to handle\r\n\t\t\t\t// destination (and custom name) was given, possibly multiple output bundles.\r\n\t\t\t\tif (maps) {\r\n\t\t\t\t\tgenerated.map.file = path.relative(originalCwd, originalPath);\r\n\t\t\t\t\tgenerated.map.sources = generated.map.sources.map(source => path.relative(originalCwd, source));\r\n\t\t\t\t}\r\n\t\t\t\t// console.log(generated.map.file);\r\n\t\t\t\t// return bundled file as buffer\r\n\t\t\t\ttargetFile.contents = Buffer.from(generated.code);\r\n\t\t\t\t// apply sourcemap to output file\r\n\t\t\t\tif (maps) {\r\n\t\t\t\t\tvinylSourcemapsApply(targetFile, generated.map);\r\n\t\t\t\t}\r\n\t\t\t\tif (i > 0) {\r\n\t\t\t\t\tthis.push(targetFile);\r\n\t\t\t\t}\r\n\t\t\t\treturn result;\r\n\t\t\t}).catch(error => {\r\n\t\t\t\tlog.error('rollup', error);\r\n\t\t\t});\r\n\t\t};\r\n\t\trollup.rollup(inputOptions).then(bundle => {\r\n\t\t\t// console.log(bundle);\r\n\t\t\tconst outputs = rollupOutput(item);\r\n\t\t\t// console.log(outputs);\r\n\t\t\tif (inputOptions.cache !== false) {\r\n\t\t\t\trollupCache.set(inputOptions.input, bundle);\r\n\t\t\t}\r\n\t\t\treturn Promise.all(outputs.map((output, i) => rollupGenerate(bundle, output, i)));\r\n\t\t\t// return bundle.write(outputs);\r\n\t\t}).then((results) => {\r\n\t\t\tresults.forEach(x => {\r\n\t\t\t\tconst outputs = x.output;\r\n\t\t\t\toutputs.forEach(x => {\r\n\t\t\t\t\tsetEntry(inputOptions.input, Object.keys(x.modules));\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t\tcallback(null, file); // pass file to gulp and end stream\r\n\t\t}).catch(error => {\r\n\t\t\tlog.error('rollup', error);\r\n\t\t\tif (inputOptions.cache !== false) {\r\n\t\t\t\trollupCache.delete(inputOptions.input);\r\n\t\t\t}\r\n\t\t\tthrow (error);\r\n\t\t\treturn callback(null, file);\r\n\t\t});\r\n\t});\r\n}\r\n\r\nfunction rollupInput(item) {\r\n\tconst output = rollupOutput(item)[0];\r\n\tconst presetEnvOptions = {\r\n\t\tmodules: false,\r\n\t\tloose: true,\r\n\t\tuseBuiltIns: false,\r\n\t};\r\n\tif (output.format === 'esm') {\r\n\t\tpresetEnvOptions.targets = {\r\n\t\t\tesmodules: true\r\n\t\t};\r\n\t} else {\r\n\t\tif (item.target) {\r\n\t\t\tpresetEnvOptions.targets = item.target; // || 'last 2 version, ie 11'; // readed from .browserslistrc\r\n\t\t}\r\n\t}\r\n\t// console.log(item.output.file, item.output, item.target, presetEnvOptions);\r\n\tconst tsconfigDefaults = {\r\n\t\tcompilerOptions: {\r\n\t\t\ttarget: 'esNext',\r\n\t\t\tmodule: 'esNext',\r\n\t\t\tlib: ['dom', 'es2015', 'es2016', 'es2017'],\r\n\t\t\tallowJs: true,\r\n\t\t\tdeclaration: false,\r\n\t\t\tsourceMap: true,\r\n\t\t\tremoveComments: output.format === 'iife',\r\n\t\t},\r\n\t\texclude: [\r\n\t\t\t'./node_modules/*',\r\n\t\t\t'.npm'\r\n\t\t]\r\n\t};\r\n\tconst tsconfigOverride = {\r\n\t\tcompilerOptions: {\r\n\t\t\ttarget: 'esNext',\r\n\t\t\tmodule: 'esNext',\r\n\t\t\tlib: ['dom', 'es2015', 'es2016', 'es2017'],\r\n\t\t\tallowJs: true,\r\n\t\t\tdeclaration: false,\r\n\t\t\tsourceMap: true,\r\n\t\t\tremoveComments: output.format === 'iife',\r\n\t\t},\r\n\t\texclude: [\r\n\t\t\t'./node_modules/*',\r\n\t\t\t'.npm'\r\n\t\t]\r\n\t};\r\n\t// const watchGlob = path.dirname(input) + '/**/*' + path.extname(input);\r\n\t// console.log('watchGlob', watchGlob);\r\n\tconst globals = Object.keys(output.globals);\r\n\tconst externals = globals.length ? globals : (item.external || []);\r\n\tconst rollupPluginCommonJsOptions = {\r\n\t\texclude: output.format === 'cjs' ? ['node_modules/**'] : undefined,\r\n\t};\r\n\tconst rollupPluginTypescript2Options = {\r\n\t\ttypescript: typescript,\r\n\t\ttsconfigDefaults: tsconfigDefaults,\r\n\t\ttsconfig: 'tsconfig.json',\r\n\t\ttsconfigOverride: tsconfigOverride,\r\n\t\trollupCommonJSResolveHack: true,\r\n\t\tclean: true,\r\n\t\tcheck: false,\r\n\t};\r\n\tconst rollupPluginBabelOptions = {\r\n\t\textensions: [\r\n\t\t\t...DEFAULT_EXTENSIONS,\r\n\t\t\t'.ts',\r\n\t\t\t'.tsx'\r\n\t\t],\r\n\t\tpresets: [\r\n\t\t\t['@babel/preset-env', presetEnvOptions],\r\n\t\t\t// ['@babel/preset-typescript', { modules: false, loose: true }]\r\n\t\t],\r\n\t\tplugins: [\r\n\t\t\t['@babel/plugin-proposal-class-properties', { loose: true }],\r\n\t\t\t'@babel/plugin-proposal-object-rest-spread',\r\n\t\t\t// '@babel/plugin-transform-runtime'\r\n\t\t],\r\n\t\texclude: ['node_modules/**'], // transpile only source code\r\n\t\t/*\r\n\t\texclude: 1 ? [] : ['node_modules/**', ...(Array.isArray(item.input) ? item.input : [item.input]).map(x => {\r\n\t\t\tif (x.indexOf('node_modules') === 0) {\r\n\t\t\t\tx = x.split('/');\r\n\t\t\t\twhile (x.length > 2) {\r\n\t\t\t\t\tx.pop();\r\n\t\t\t\t}\r\n\t\t\t\treturn `!${x.join('/')}/**`;\r\n\t\t\t} else {\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t}).filter(x => x)],\r\n\t\t*/\r\n\t\tcomments: output.format !== 'iife',\r\n\t\tbabelHelpers: 'bundled',\r\n\t\t// babelrc: false,\r\n\t};\r\n\tconst rollupPluginLicenseOptions = {\r\n\t\tbanner: `@license <%= pkg.name %> v<%= pkg.version %>\r\n\t\t(c) <%= moment().format('YYYY') %> <%= pkg.author %>\r\n\t\tLicense: <%= pkg.license %>`,\r\n\t};\r\n\tconst plugins = [\r\n\t\t// Resolve source maps to the original source\r\n\t\trollupPluginSourcemaps(),\r\n\t\t// Allow node_modules resolution, so you can use 'external' to control\r\n\t\t// which external modules to include in the bundle\r\n\t\t// https://github.com/rollup/rollup-plugin-node-resolve#usage\r\n\t\t// import node modules\r\n\t\t/*\r\n\t\toutput.format === 'cjs' ? null : (typeof rollupPluginNodeResolve === 'function' ? rollupPluginNodeResolve : rollupPluginNodeResolve.nodeResolve)({\r\n\t\t\tresolveOnly: [new RegExp(`^(?!(${externals.join('$|')}$))`)]\r\n\t\t}),\r\n\t\t*/\r\n\t\toutput.format === 'cjs' ? null : (typeof rollupPluginNodeResolve === 'function' ? rollupPluginNodeResolve : rollupPluginNodeResolve.nodeResolve)(),\r\n\t\t// exclude: Object.keys(output.globals).map(x => `node_module/${x}/**`),\r\n\t\t// Allow bundling cjs modules (unlike webpack, rollup doesn't understand cjs)\r\n\t\trollupPluginCommonJs(rollupPluginCommonJsOptions),\r\n\t\t// Compile TypeScript files\r\n\t\tpath.extname(item.input) === '.ts' ? rollupPluginTypescript2(rollupPluginTypescript2Options) : null,\r\n\t\trollupPluginBabel(rollupPluginBabelOptions),\r\n\t\trollupPluginLicense(rollupPluginLicenseOptions),\r\n\t].filter(x => x);\r\n\t// console.log('plugins', rollupPluginBabelOptions, plugins);\r\n\tconst input = {\r\n\t\tinput: item.input,\r\n\t\tplugins: plugins,\r\n\t\texternal: externals,\r\n\t\tcache: false, // !! break babel if true\r\n\t\ttreeshake: true,\r\n\t\t/*\r\n\t\twatch: {\r\n\t\t\tinclude: watchGlob,\r\n\t\t},\r\n\t\t*/\r\n\t};\r\n\treturn input;\r\n}\r\n\r\nfunction rollupOutput(item) {\r\n\tconst outputs = Array.isArray(item.output) ? item.output : [item.output];\r\n\tconst output = outputs[0];\r\n\tconst default_ = {\r\n\t\tformat: 'iife',\r\n\t\tname: item.name || null,\r\n\t\tglobals: (typeof output === 'object' && output.globals) || item.globals || {},\r\n\t\tsourcemap: true,\r\n\t\tcompact: item.minify || false,\r\n\t};\r\n\treturn outputs.map(x => {\r\n\t\tlet output = Object.assign({}, default_);\r\n\t\tif (typeof x === 'string') {\r\n\t\t\toutput.file = x;\r\n\t\t} else if (typeof x === 'object') {\r\n\t\t\toutput = Object.assign(output, x);\r\n\t\t}\r\n\t\toutput.name = output.name || path.basename(output.file, '.js');\r\n\t\treturn output;\r\n\t});\r\n}\r\n\r\nmodule.exports = {\r\n\trollup: rollup_,\r\n\trollupInput,\r\n\trollupOutput,\r\n};\r\n","const typescript = require('typescript'),\r\n\tfs = require('fs'),\r\n\tpath = require('path'),\r\n\tprocess = require('process'),\r\n\tthrough2 = require('through2'),\r\n\tvinyl = require('vinyl'),\r\n\tvinylSourcemapsApply = require('vinyl-sourcemaps-apply');\r\n\r\nconst log = require('../logger/logger');\r\nconst { service } = require('../config/config');\r\nconst { getObject, extend } = require('../config/json');\r\nconst { rollupOutput } = require('./rollup');\r\n\r\nfunction typescript_(item) {\r\n\tconst output = rollupOutput(item)[0];\r\n\tswitch (output.format) {\r\n\t\tcase 'iife':\r\n\t\tcase 'umd':\r\n\t\t\treturn;\r\n\t\tdefault:\r\n\t\t\treturn typescriptLib(item, output);\r\n\t}\r\n}\r\n\r\nfunction typescriptLib(item, output) {\r\n\treturn through2.obj(function(file, enc, callback) {\r\n\t\t// console.log('TfsCheckout', file.path);\r\n\t\tif (file.isNull()) {\r\n\t\t\treturn callback(null, file);\r\n\t\t}\r\n\t\tif (file.isStream()) {\r\n\t\t\tconsole.warn('Rollup, Streaming not supported');\r\n\t\t\treturn callback(null, file);\r\n\t\t}\r\n\t\tconst result = typescriptCompile(file, item, output);\r\n\t\treturn callback(null, file);\r\n\t});\r\n}\r\n\r\nfunction typescriptCompile(file, item) {\r\n\t// Extract configuration from config file\r\n\tconst config = typescriptConfig(item);\r\n\t// console.log('fileNames', config.fileNames);\r\n\t// console.log('options', config.options);\r\n\r\n\t// return 0;\r\n\tconst program = typescript.createProgram(config.fileNames, config.options);\r\n\tconst emitResult = program.emit();\r\n\t// console.log('emitResult', emitResult);\r\n\r\n\t// Report errors\r\n\ttypescriptDiagnostic(typescript.getPreEmitDiagnostics(program).concat(emitResult.diagnostics));\r\n\r\n\t// Return code\r\n\tconst exitCode = emitResult.emitSkipped ? 1 : 0;\r\n\t// console.log('exitCode', exitCode);\r\n\treturn exitCode;\r\n\tprocess.exit(exitCode);\r\n}\r\n\r\nfunction typescriptConfig(item) {\r\n\tconst configFileName = 'tsconfig.json';\r\n\tconst configDefault = {\r\n\t\tcompilerOptions: {\r\n\t\t\ttypeRoots: ['node_modules/@types'],\r\n\t\t\tstrict: false\r\n\t\t}\r\n\t};\r\n\t/*\r\n\t\"baseUrl\": \"\",\r\n\t\"mapRoot\": \"./\",\r\n\t*/\r\n\tlet configOverride = {\r\n\t\tfiles: [item.input],\r\n\t\tcompilerOptions: {\r\n\t\t\tmoduleResolution: 'node',\r\n\t\t\texperimentalDecorators: true,\r\n\t\t\temitDecoratorMetadata: true,\r\n\t\t\t// removeComments: true,\r\n\t\t\timportHelpers: true,\r\n\t\t\tallowSyntheticDefaultImports: true,\r\n\t\t\tesModuleInterop: true,\r\n\t\t\tallowJs: true,\r\n\t\t},\r\n\t\texclude: [\r\n\t\t\t'node_modules',\r\n\t\t\t'.npm'\r\n\t\t]\r\n\t};\r\n\tconst output = rollupOutput(item)[0];\r\n\t// console.log(output);\r\n\tswitch (output.format) {\r\n\t\tcase 'amd':\r\n\t\t\tconfigOverride = extend(configOverride, {\r\n\t\t\t\tcompilerOptions: {\r\n\t\t\t\t\ttarget: 'es5',\r\n\t\t\t\t\tmodule: 'amd',\r\n\t\t\t\t\toutFile: output.file,\r\n\t\t\t\t\tlib: ['dom', 'es2015', 'es2016', 'es2017'],\r\n\t\t\t\t\tdeclaration: false,\r\n\t\t\t\t\tsourceMap: true,\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tbreak;\r\n\t\tcase 'cjs':\r\n\t\t\tconfigOverride = extend(configOverride, {\r\n\t\t\t\tcompilerOptions: {\r\n\t\t\t\t\ttarget: 'es5',\r\n\t\t\t\t\tmodule: 'commonJS',\r\n\t\t\t\t\toutDir: output.file,\r\n\t\t\t\t\tlib: ['dom', 'es2015', 'es2016', 'es2017'],\r\n\t\t\t\t\tdeclaration: true,\r\n\t\t\t\t\tsourceMap: false,\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tbreak;\r\n\t\tcase 'esm':\r\n\t\t\tconfigOverride = extend(configOverride, {\r\n\t\t\t\tcompilerOptions: {\r\n\t\t\t\t\ttarget: 'es2015',\r\n\t\t\t\t\tmodule: 'es6',\r\n\t\t\t\t\toutDir: output.file,\r\n\t\t\t\t\tlib: ['dom', 'es2015', 'es2016', 'es2017'],\r\n\t\t\t\t\tdeclaration: true,\r\n\t\t\t\t\tsourceMap: false,\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tbreak;\r\n\t\tcase 'system':\r\n\t\t\tconfigOverride = extend(configOverride, {\r\n\t\t\t\tcompilerOptions: {\r\n\t\t\t\t\ttarget: 'es5',\r\n\t\t\t\t\tmodule: 'system',\r\n\t\t\t\t\toutFile: output.file,\r\n\t\t\t\t\tlib: ['dom', 'es2015', 'es2016', 'es2017'],\r\n\t\t\t\t\tdeclaration: false,\r\n\t\t\t\t\tsourceMap: true,\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tbreak;\r\n\t}\r\n\tconst config = getObject(`./${configFileName}`, configDefault, configOverride);\r\n\tconst configFileText = JSON.stringify(config);\r\n\t// Parse JSON, after removing comments. Just fancier JSON.parse\r\n\tconst result = typescript.parseConfigFileTextToJson(configFileName, configFileText);\r\n\tconst configObject = result.config;\r\n\tif (!configObject) {\r\n\t\ttypescriptDiagnostic([result.error]);\r\n\t\treturn;\r\n\t}\r\n\t// Extract config infromation\r\n\tconst configParseResult = typescript.parseJsonConfigFileContent(configObject, typescript.sys, path.dirname(configFileName));\r\n\tif (configParseResult.errors.length > 0) {\r\n\t\ttypescriptDiagnostic(configParseResult.errors);\r\n\t\treturn;\r\n\t}\r\n\treturn configParseResult;\r\n}\r\n\r\nfunction typescriptDiagnostic(diagnostics) {\r\n\tdiagnostics.forEach(diagnostic => {\r\n\t\tlet message = 'Error';\r\n\t\tif (diagnostic.file) {\r\n\t\t\tconst where = diagnostic.file.getLineAndCharacterOfPosition(diagnostic.start);\r\n\t\t\tmessage += ' ' + diagnostic.file.fileName + ' ' + where.line + ', ' + where.character + 1;\r\n\t\t}\r\n\t\tmessage += ': ' + typescript.flattenDiagnosticMessageText(diagnostic.messageText, '\\n');\r\n\t\tconsole.log(message);\r\n\t});\r\n}\r\n\r\nmodule.exports = {\r\n\ttypescript: typescript_,\r\n};\r\n\r\n/*\r\nconst RollupFormats = {\r\n\t'amd': 'amd', // Asynchronous Module Definition, used with module loaders like RequireJS\r\n\t'cjs': 'cjs', // CommonJS, suitable for Node and other bundlers\r\n\t'esm': 'esm', // Keep the bundle as an ES module file, suitable for other bundlers and inclusion as a <script type=module> tag in modern browsers\r\n\t'iife': 'iife', // A self-executing function, suitable for inclusion as a <script> tag. (If you want to create a bundle for your application, you probably want to use this.)\r\n\t'umd': 'umd', // Universal Module Definition, works as amd, cjs and iife all in one\r\n\t'system': 'system', // Native format of the SystemJS loader\r\n};\r\n\r\nconst TypescriptTarget = [\"ES3\", \"ES5\", \"ES6\", \"ES2015\", \"ES2016\", \"ES2017\", \"ES2018\", \"ES2019\", \"ES2020\", \"ESNext\"];\r\nconst TypescriptModule = [\"CommonJS\", \"AMD\", \"System\", \"UMD\", \"ES6\", \"ES2015\", \"ESNext\", \"None\"];\r\n*/\r\n","const cssnano = require('cssnano'),\r\n\tgulpAutoprefixer = require('gulp-autoprefixer'),\r\n\tgulpConnect = require('gulp-connect'),\r\n\tgulpFilter = require('gulp-filter'),\r\n\tgulpHtmlExtend = require('gulp-html-extend'),\r\n\tgulpHtmlMin = require('gulp-htmlmin'),\r\n\tgulpIf = require('gulp-if'),\r\n\tgulpPlumber = require('gulp-plumber'),\r\n\tgulpPostcss = require('gulp-postcss'),\r\n\tgulpRename = require('gulp-rename'),\r\n\tgulpTerser = require('gulp-terser'),\r\n\tpath = require('path');\r\n\r\nconst { dest, parallel, series, src } = require('gulp');\r\n\r\nconst { setEntry } = require('../watch/watch');\r\n\r\nconst log = require('../logger/logger');\r\nconst { service } = require('../config/config');\r\nconst tfsCheckout = require('../tfs/tfs');\r\nconst { sass } = require('./sass');\r\nconst { mjml } = require('./mjml');\r\n\r\nconst { rollup, rollupOutput } = require('./rollup');\r\nconst { typescript } = require('./typescript');\r\n\r\nfunction compile(item, ext, done) {\r\n\t// console.log('compile', ext, item);\r\n\tlet task;\r\n\tswitch (ext) {\r\n\t\tcase '.scss':\r\n\t\t\ttask = compileScssItem(item);\r\n\t\t\tbreak;\r\n\t\tcase '.js':\r\n\t\tcase '.mjs':\r\n\t\t\ttask = compileJsItem(item);\r\n\t\t\tbreak;\r\n\t\tcase '.ts':\r\n\t\tcase '.tsx':\r\n\t\t\ttask = compileTsItem(item);\r\n\t\t\tbreak;\r\n\t\tcase '.html':\r\n\t\t\ttask = compileHtmlItem(item);\r\n\t\t\tbreak;\r\n\t\tcase '.mjml':\r\n\t\t\ttask = compileMjmlItem(item);\r\n\t\t\tbreak;\r\n\t}\r\n\treturn task ? task : (typeof done === 'function' ? done() : null);\r\n}\r\n\r\nfunction compileScss(done) {\r\n\tconst items = compiles('.scss');\r\n\tconst tasks = items.map(item => function compileScss() {\r\n\t\treturn compileScssItem(item);\r\n\t});\r\n\treturn tasks.length ? parallel(...tasks)(done) : done();\r\n}\r\n\r\nfunction compileScssItem(item) {\r\n\treturn src(item.input, { base: '.', allowEmpty: true, sourcemaps: true })\r\n\t\t.pipe(gulpPlumber())\r\n\t\t.pipe(sass({\r\n\t\t\tincludePaths: ['./node_modules/', __dirname + '/node_modules', 'node_modules'],\r\n\t\t}).on('compile:scss.error', (error) => {\r\n\t\t\tlog.error('compile:scss', error);\r\n\t\t}))\r\n\t\t.pipe(gulpAutoprefixer())\r\n\t\t.pipe(gulpRename(item.output))\r\n\t\t.pipe(tfsCheckout())\r\n\t\t.pipe(dest('.', item.minify ? null : { sourcemaps: '.' }))\r\n\t\t.pipe(gulpFilter('**/*.css'))\r\n\t\t.on('end', () => log('Compile', item.output))\r\n\t\t.pipe(gulpIf(item.minify, gulpPostcss([\r\n\t\t\t// gulpAutoprefixer({browsers: ['last 1 version']}),\r\n\t\t\tcssnano()\r\n\t\t])))\r\n\t\t.pipe(gulpIf(item.minify, gulpRename({ extname: '.min.css' })))\r\n\t\t.pipe(tfsCheckout(!item.minify))\r\n\t\t.pipe(gulpIf(item.minify, dest('.', { sourcemaps: '.' })))\r\n\t\t.pipe(gulpFilter('**/*.css'))\r\n\t\t.pipe(gulpConnect.reload());\r\n}\r\n\r\nfunction compileJs(done) {\r\n\tconst items = compiles('.js', '.mjs');\r\n\tconst tasks = items.map(item => function compileJs(done) {\r\n\t\treturn compileJsItem(item, done);\r\n\t});\r\n\treturn tasks.length ? parallel(...tasks)(done) : done();\r\n}\r\n\r\nfunction compileJsItem(item, done) {\r\n\tconst tasks = [];\r\n\tconst outputs = rollupOutput(item);\r\n\toutputs.forEach((output, i) => {\r\n\t\ttasks.push(function compileJsItem(done) {\r\n\t\t\tconst item_ = Object.assign({}, item, { output });\r\n\t\t\treturn compileRollup(item_);\r\n\t\t});\r\n\t});\r\n\treturn tasks.length ? series(...tasks)(done) : done();\r\n}\r\n\r\nfunction compileTs(done) {\r\n\tconst items = compiles('.ts', '.tsx');\r\n\tconst tasks = items.map(item => function compileTs(done) {\r\n\t\treturn compileTsItem(item, done);\r\n\t});\r\n\treturn tasks.length ? parallel(...tasks)(done) : done();\r\n}\r\n\r\nfunction compileTsItem(item, done) {\r\n\tconst tasks = [];\r\n\tconst outputs = rollupOutput(item);\r\n\toutputs.forEach((output, i) => {\r\n\t\ttasks.push(function compileTsItem(done) {\r\n\t\t\tconst item_ = Object.assign({}, item, { output });\r\n\t\t\tconst output_ = rollupOutput(item_)[0];\r\n\t\t\tlet task;\r\n\t\t\tswitch (output_.format) {\r\n\t\t\t\tcase 'iife':\r\n\t\t\t\tcase 'umd':\r\n\t\t\t\t\ttask = compileRollup(item_);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\ttask = compileTypescript(item_);\r\n\t\t\t}\r\n\t\t\treturn task;\r\n\t\t});\r\n\t});\r\n\treturn tasks.length ? series(...tasks)(done) : done();\r\n}\r\n\r\nfunction compileHtml(done) {\r\n\tconst items = compiles('.html');\r\n\tconst tasks = items.map(item => function compileHtml() {\r\n\t\treturn compileHtmlItem(item);\r\n\t});\r\n\treturn tasks.length ? parallel(...tasks)(done) : done();\r\n}\r\n\r\nfunction compileHtmlItem(item) {\r\n\tsetEntry(item.input, path.extname(item.input));\r\n\treturn src(item.input, { base: '.', allowEmpty: true, sourcemaps: true })\r\n\t\t.pipe(gulpPlumber())\r\n\t\t.pipe(gulpHtmlExtend({ annotations: true, verbose: false }))\r\n\t\t.pipe(gulpIf(item.minify, gulpHtmlMin({ collapseWhitespace: true })))\r\n\t\t.pipe(gulpRename(function(path) {\r\n\t\t\treturn {\r\n\t\t\t\tdirname: item.output,\r\n\t\t\t\tbasename: path.basename,\r\n\t\t\t\textname: path.extname,\r\n\t\t\t};\r\n\t\t}))\r\n\t\t.pipe(tfsCheckout())\r\n\t\t.pipe(dest('.'))\r\n\t\t.on('end', () => log('Compile', item.output))\r\n\t\t.pipe(gulpConnect.reload());\r\n}\r\n\r\nfunction compileMjml(done) {\r\n\tconst items = compiles('.mjml');\r\n\tconst tasks = items.map(item => function compileMjml() {\r\n\t\treturn compileMjmlItem(item);\r\n\t});\r\n\treturn tasks.length ? parallel(...tasks)(done) : done();\r\n}\r\n\r\nfunction compileMjmlItem(item) {\r\n\tsetEntry(item.input, path.extname(item.input));\r\n\treturn src(item.input, { base: '.', allowEmpty: true, sourcemaps: true })\r\n\t\t.pipe(gulpPlumber())\r\n\t\t.pipe(mjml(item))\r\n\t\t.pipe(gulpRename(function(path) {\r\n\t\t\treturn {\r\n\t\t\t\tdirname: item.output,\r\n\t\t\t\tbasename: path.basename,\r\n\t\t\t\textname: path.extname,\r\n\t\t\t};\r\n\t\t}))\r\n\t\t.pipe(tfsCheckout())\r\n\t\t.pipe(dest('.'))\r\n\t\t.on('end', () => log('Compile', item.output))\r\n\t\t.pipe(gulpConnect.reload());\r\n}\r\n\r\nfunction compileRollup(item) {\r\n\tconst outputs = rollupOutput(item);\r\n\tconst minify = item.minify || outputs[0].minify;\r\n\tif (item.output.minify !== undefined) {\r\n\t\tdelete item.output.minify;\r\n\t\titem.output.compact = minify;\r\n\t}\r\n\treturn src(item.input, { base: '.', allowEmpty: true, sourcemaps: true })\r\n\t\t.pipe(gulpPlumber())\r\n\t\t.pipe(rollup(item))\r\n\t\t/*\r\n\t\t.pipe(gulpRename(function(file) {\r\n\t\t\tconst output = outputs.find(x => {\r\n\t\t\t\t// console.log('file', x.file, file.basename, x.file.indexOf(file.basename));\r\n\t\t\t\treturn x.file.indexOf(file.basename) !== -1;\r\n\t\t\t});\r\n\t\t\tfile.dirname = path.dirname(output.file);\r\n\t\t}))\r\n\t\t*/\r\n\t\t.pipe(tfsCheckout())\r\n\t\t.pipe(dest('.', minify ? null : { sourcemaps: '.' }))\r\n\t\t.pipe(gulpFilter('**/*.js'))\r\n\t\t.on('end', () => log('Compile', outputs.map(x => x.file).join(', ')))\r\n\t\t.pipe(gulpIf(minify, gulpTerser()))\r\n\t\t.pipe(gulpIf(minify, gulpRename({ extname: '.min.js' })))\r\n\t\t.pipe(tfsCheckout(!minify))\r\n\t\t.pipe(gulpIf(minify, dest('.', { sourcemaps: '.' })))\r\n\t\t.pipe(gulpFilter('**/*.js'))\r\n\t\t.pipe(gulpConnect.reload());\r\n}\r\n\r\nfunction compileTypescript(item) {\r\n\tconst outputs = rollupOutput(item);\r\n\tconst minify = item.minify || outputs[0].minify;\r\n\treturn src(item.input, { base: '.', allowEmpty: true, sourcemaps: true })\r\n\t\t.pipe(gulpPlumber())\r\n\t\t.pipe(typescript(item))\r\n\t\t/*\r\n\t\t// .pipe(gulpRename(item.output))\r\n\t\t.pipe(tfsCheckout())\r\n\t\t.pipe(dest('.', minify ? null : { sourcemaps: '.' }))\r\n\t\t*/\r\n\t\t.pipe(gulpFilter('**/*.js'))\r\n\t\t.on('end', () => log('Compile', outputs.map(x => x.file).join(', ')))\r\n\t\t/*\r\n\t\t.pipe(gulpIf(minify, gulpTerser()))\r\n\t\t.pipe(gulpIf(minify, gulpRename({ extname: '.min.js' })))\r\n\t\t.pipe(tfsCheckout(!minify))\r\n\t\t.pipe(gulpIf(minify, dest('.', { sourcemaps: '.' })))\r\n\t\t*/\r\n\t\t.pipe(gulpFilter('**/*.js'))\r\n\t\t.pipe(gulpConnect.reload());\r\n}\r\n\r\nfunction compiles(...args) {\r\n\tif (service.config) {\r\n\t\treturn service.config.compile.filter((item) => {\r\n\t\t\treturn args.find(ext => item.input.lastIndexOf(ext) === item.input.length - ext.length) !== undefined;\r\n\t\t});\r\n\t} else {\r\n\t\treturn [];\r\n\t}\r\n}\r\n\r\nfunction globs(ext) {\r\n\treturn compiles(ext).map(x => {\r\n\t\treturn x.input.replace(/\\/[^\\/]*$/, '/**/*' + ext);\r\n\t});\r\n}\r\n\r\nmodule.exports = {\r\n\tcompile,\r\n\tcompileScss,\r\n\tcompileScssItem,\r\n\tcompileJs,\r\n\tcompileJsItem,\r\n\tcompileTs,\r\n\tcompileTsItem,\r\n\tcompileHtml,\r\n\tcompileMjml,\r\n\tcompileMjmlItem,\r\n};\r\n\r\n/*\r\n'iife': 'iife', // A self-executing function, suitable for inclusion as a <script> tag. (If you want to create a bundle for your application, you probably want to use this.)\r\n'umd': 'umd', // Universal Module Definition, works as amd, cjs and iife all in one\r\n'amd': 'amd', // Asynchronous Module Definition, used with module loaders like RequireJS\r\n'cjs': 'cjs', // CommonJS, suitable for Node and other bundlers\r\n'esm': 'esm', // Keep the bundle as an ES module file, suitable for other bundlers and inclusion as a <script type=module> tag in modern browsers\r\n'system': 'system', // Native format of the SystemJS loader\r\n*/\r\n","const cssnano = require('cssnano'),\r\n\tgulpFilter = require('gulp-filter'),\r\n\tgulpIf = require('gulp-if'),\r\n\tgulpPlumber = require('gulp-plumber'),\r\n\tgulpPostcss = require('gulp-postcss'),\r\n\tgulpRename = require('gulp-rename'),\r\n\tgulpTerser = require('gulp-terser'),\r\n\tgulpConcat = require('gulp-concat');\r\n\r\nconst { dest, parallel, src, watch } = require('gulp');\r\n\r\nconst log = require('../logger/logger');\r\nconst { service } = require('../config/config');\r\nconst tfsCheckout = require('../tfs/tfs');\r\nconst { setEntry } = require('../watch/watch');\r\n\r\nfunction bundle(item, ext, done) {\r\n\tlet task;\r\n\tswitch (ext) {\r\n\t\tcase '.scss':\r\n\t\t\ttask = bundleCssItem(item);\r\n\t\t\tbreak;\r\n\t\tcase '.js':\r\n\t\t\ttask = bundleJsItem(item);\r\n\t\t\tbreak;\r\n\t}\r\n\treturn task ? task : (typeof done === 'function' ? done() : null);\r\n}\r\n\r\nfunction bundleCss(done) {\r\n\tconst items = bundles('.css');\r\n\tconst tasks = items.map(item => function bundleCss(done) {\r\n\t\tsetEntry(item.output, Array.isArray(item.input) ? item.input : [item.input]);\r\n\t\treturn bundleCssItem(item);\r\n\t});\r\n\treturn tasks.length ? parallel(...tasks)(done) : done();\r\n}\r\n\r\nfunction bundleCssItem(item) {\r\n\tconst skip = item.input.length === 1 && item.input[0] === item.output;\r\n\tconst plugins = [\r\n\t\t// autoprefixer({browsers: ['last 1 version']}),\r\n\t\tcssnano()\r\n\t];\r\n\treturn src(item.input, { base: '.', allowEmpty: true, sourcemaps: true })\r\n\t\t.pipe(gulpPlumber())\r\n\t\t.pipe(gulpIf(!skip, gulpConcat(item.output)))\r\n\t\t.pipe(tfsCheckout(skip))\r\n\t\t.pipe(gulpIf(!skip, dest('.')))\r\n\t\t.on('end', () => log('Bundle', item.output))\r\n\t\t.pipe(gulpIf(item.minify, gulpPostcss(plugins)))\r\n\t\t.pipe(gulpIf(item.minify, gulpRename({ extname: '.min.css' })))\r\n\t\t.pipe(tfsCheckout(!item.minify))\r\n\t\t.pipe(gulpIf(item.minify, dest('.', { sourcemaps: '.' })))\r\n\t\t.pipe(gulpFilter('**/*.css'));\r\n}\r\n\r\nfunction bundleJs(done) {\r\n\tconst items = bundles('.js');\r\n\tconst tasks = items.map(item => function bundleJs(done) {\r\n\t\tsetEntry(item.output, Array.isArray(item.input) ? item.input : [item.input]);\r\n\t\treturn bundleJsItem(item);\r\n\t});\r\n\treturn tasks.length ? parallel(...tasks)(done) : done();\r\n}\r\n\r\nfunction bundleJsItem(item) {\r\n\tconst skip = item.input.length === 1 && item.input[0] === item.output;\r\n\treturn src(item.input, { base: '.', allowEmpty: true, sourcemaps: true })\r\n\t\t.pipe(gulpPlumber())\r\n\t\t.pipe(gulpIf(!skip, gulpConcat(item.output)))\r\n\t\t.pipe(tfsCheckout(skip))\r\n\t\t.pipe(gulpIf(!skip, dest('.')))\r\n\t\t.on('end', () => log('Bundle', item.output))\r\n\t\t.pipe(gulpIf(item.minify, gulpTerser()))\r\n\t\t.pipe(gulpIf(item.minify, gulpRename({ extname: '.min.js' })))\r\n\t\t.pipe(tfsCheckout(!item.minify))\r\n\t\t.pipe(gulpIf(item.minify, dest('.', { sourcemaps: '.' })))\r\n\t\t.pipe(gulpFilter('**/*.js'));\r\n}\r\n\r\nfunction bundles(...args) {\r\n\tif (service.config) {\r\n\t\treturn service.config.bundle.filter((item) => {\r\n\t\t\treturn args.find(ext => item.output.lastIndexOf(ext) === item.output.length - ext.length) !== undefined;\r\n\t\t});\r\n\t} else {\r\n\t\treturn [];\r\n\t}\r\n}\r\n\r\nmodule.exports = {\r\n\tbundle,\r\n\tbundleCss,\r\n\tbundleCssItem,\r\n\tbundleJs,\r\n\tbundleJsItem,\r\n\tbundles,\r\n};\r\n","const gulpIf = require('gulp-if'),\r\n\tgulpPlumber = require('gulp-plumber'),\r\n\tgulpRename = require('gulp-rename');\r\n\r\nconst { dest, parallel, src, watch } = require('gulp');\r\n\r\nconst log = require('../logger/logger');\r\nconst { service } = require('../config/config');\r\nconst tfsCheckout = require('../tfs/tfs');\r\nconst { setEntry } = require('../watch/watch');\r\n\r\nfunction copy(item, ext, done) {\r\n\t// console.log('copy', ext, item);\r\n\tlet task;\r\n\tswitch (ext) {\r\n\t\tdefault:\r\n\t\t\ttask = copyItemTask(item);\r\n\t}\r\n\treturn task ? task : (typeof done === 'function' ? done() : null);\r\n}\r\n\r\nfunction copyTask(done) {\r\n\tconst items = copies(service.config);\r\n\tconst tasks = items.map(item => function copy(done) {\r\n\t\treturn copyItemTask(item);\r\n\t});\r\n\treturn tasks.length ? parallel(...tasks)(done) : done();\r\n}\r\n\r\nfunction copyItemTask(item) {\r\n\tconst skip = item.input.length === 1 && item.input[0] === item.output;\r\n\tconst base = item.base ||\r\n\t\t(typeof item.input === 'string' && item.input.indexOf('**/*.*') !== -1 ? item.input.split('**/*.*')[0] : '.');\r\n\treturn src(item.input, { base, allowEmpty: true, sourcemaps: false })\r\n\t\t.pipe(gulpPlumber())\r\n\t\t.pipe(gulpIf(base === '.', gulpRename({ dirname: item.output })))\r\n\t\t.pipe(gulpIf(!skip, base === '.' ? dest('.') : dest(item.output)))\r\n\t\t.pipe(tfsCheckout(skip))\r\n\t\t.on('end', () => log('Bundle', item.output));\r\n}\r\n\r\nfunction copies() {\r\n\tif (service.config) {\r\n\t\treturn service.config.copy || [];\r\n\t} else {\r\n\t\treturn [];\r\n\t}\r\n}\r\n\r\nmodule.exports = {\r\n\tcopy,\r\n\tcopyTask,\r\n\tcopyItemTask,\r\n\tcopies,\r\n};\r\n","const gulpConnect = require('gulp-connect'),\r\n\turl = require('url'),\r\n\tfs = require('fs');\r\n\r\nconst log = require('../logger/logger');\r\nconst { service } = require('../config/config');\r\n\r\n// SERVE\r\nfunction serve(done) {\r\n\tif (service.config.server) {\r\n\t\tconst options = Object.assign({\r\n\t\t\tname: 'Development',\r\n\t\t\troot: './docs',\r\n\t\t\tport: 8001,\r\n\t\t\thost: 'localhost',\r\n\t\t\thttps: false,\r\n\t\t\tpath: '/',\r\n\t\t\tlivereload: true,\r\n\t\t}, service.config.server || {});\r\n\t\tif (options.https && options.https.cert) {\r\n\t\t\toptions.https.cert = fs.readFileSync(options.https.cert);\r\n\t\t}\r\n\t\toptions.fallback = `${options.path}index.html`;\r\n\t\tconst middleware = middleware_({\r\n\t\t\tlogger: options.log ? log : undefined,\r\n\t\t\trewrites: [{\r\n\t\t\t\tfrom: new RegExp(`^${options.path}.*$`),\r\n\t\t\t\tto: (context) => {\r\n\t\t\t\t\treturn context.parsedUrl.pathname.replace(options.path, '/');\r\n\t\t\t\t}\r\n\t\t\t}]\r\n\t\t});\r\n\t\toptions.middleware = (connect, opt) => {\r\n\t\t\treturn [middleware];\r\n\t\t};\r\n\t\tgulpConnect.server(options, function() {\r\n\t\t\tthis.server.on('close', done);\r\n\t\t});\r\n\t} else {\r\n\t\tdone();\r\n\t}\r\n}\r\n\r\nfunction middleware_(options) {\r\n\toptions = options || {};\r\n\tconst logger = getLogger(options);\r\n\treturn function(req, res, next) {\r\n\t\tconst headers = req.headers;\r\n\t\tif (!headers || typeof headers.accept !== 'string') {\r\n\t\t\tlogger(\r\n\t\t\t\t'Not rewriting',\r\n\t\t\t\treq.method,\r\n\t\t\t\treq.url,\r\n\t\t\t\t'because the client did not send an HTTP accept header.'\r\n\t\t\t);\r\n\t\t\treturn next();\r\n\t\t} else if (headers.accept.indexOf('application/json') === 0) {\r\n\t\t\tif (req.url.indexOf('.json') !== -1) {\r\n\t\t\t\treq.method = 'GET';\r\n\t\t\t}\r\n\t\t\t/*\r\n\t\t\tlogger(\r\n\t\t\t\t'Not rewriting',\r\n\t\t\t\treq.method,\r\n\t\t\t\treq.url,\r\n\t\t\t\t'because the client prefers JSON.'\r\n\t\t\t);\r\n\t\t\treturn next();\r\n\t\t\t*/\r\n\t\t} else if (req.method !== 'GET') {\r\n\t\t\tlogger(\r\n\t\t\t\t'Not rewriting',\r\n\t\t\t\treq.method,\r\n\t\t\t\treq.url,\r\n\t\t\t\t'because the method is not GET.'\r\n\t\t\t);\r\n\t\t\treturn next();\r\n\t\t} else if (!acceptsHtml(headers.accept, options)) {\r\n\t\t\tlogger(\r\n\t\t\t\t'Not rewriting',\r\n\t\t\t\treq.method,\r\n\t\t\t\treq.url,\r\n\t\t\t\t'because the client does not accept HTML.'\r\n\t\t\t);\r\n\t\t\treturn next();\r\n\t\t}\r\n\t\tconst parsedUrl = url.parse(req.url);\r\n\t\tlet rewriteTarget;\r\n\t\toptions.rewrites = options.rewrites || [];\r\n\t\tfor (let i = 0; i < options.rewrites.length; i++) {\r\n\t\t\tconst rewrite = options.rewrites[i];\r\n\t\t\tconst match = parsedUrl.pathname.match(rewrite.from);\r\n\t\t\tif (match !== null) {\r\n\t\t\t\trewriteTarget = evaluateRewriteRule(parsedUrl, match, rewrite.to, req);\r\n\t\t\t\tif (rewriteTarget.charAt(0) !== '/') {\r\n\t\t\t\t\tlogger(\r\n\t\t\t\t\t\t'We recommend using an absolute path for the rewrite target.',\r\n\t\t\t\t\t\t'Received a non-absolute rewrite target',\r\n\t\t\t\t\t\trewriteTarget,\r\n\t\t\t\t\t\t'for URL',\r\n\t\t\t\t\t\treq.url\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t\tlogger('Rewriting', req.method, req.url, 'to', rewriteTarget);\r\n\t\t\t\treq.url = rewriteTarget;\r\n\t\t\t\treturn next();\r\n\t\t\t}\r\n\t\t}\r\n\t\tconst pathname = parsedUrl.pathname;\r\n\t\tif (pathname.lastIndexOf('.') > pathname.lastIndexOf('/') &&\r\n\t\t\toptions.disableDotRule !== true) {\r\n\t\t\tlogger(\r\n\t\t\t\t'Not rewriting',\r\n\t\t\t\treq.method,\r\n\t\t\t\treq.url,\r\n\t\t\t\t'because the path includes a dot (.) character.'\r\n\t\t\t);\r\n\t\t\treturn next();\r\n\t\t}\r\n\t\trewriteTarget = options.index || '/index.html';\r\n\t\tlogger('Rewriting', req.method, req.url, 'to', rewriteTarget);\r\n\t\treq.url = rewriteTarget;\r\n\t\tnext();\r\n\t};\r\n};\r\n\r\nfunction evaluateRewriteRule(parsedUrl, match, rule, req) {\r\n\tif (typeof rule === 'string') {\r\n\t\treturn rule;\r\n\t} else if (typeof rule !== 'function') {\r\n\t\tthrow new Error('Rewrite rule can only be of type string or function.');\r\n\t}\r\n\treturn rule({\r\n\t\tparsedUrl: parsedUrl,\r\n\t\tmatch: match,\r\n\t\trequest: req\r\n\t});\r\n}\r\n\r\nfunction acceptsHtml(header, options) {\r\n\toptions.htmlAcceptHeaders = options.htmlAcceptHeaders || ['text/html', '*/*'];\r\n\tfor (let i = 0; i < options.htmlAcceptHeaders.length; i++) {\r\n\t\tif (header.indexOf(options.htmlAcceptHeaders[i]) !== -1) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nfunction getLogger(options) {\r\n\tif (options && options.logger) {\r\n\t\treturn options.logger;\r\n\t} else if (options && options.verbose) {\r\n\t\t// eslint-disable-next-line no-console\r\n\t\treturn console.log.bind(console);\r\n\t}\r\n\treturn function() {};\r\n}\r\n\r\nmodule.exports = {\r\n\tserve,\r\n};\r\n","const path = require('path');\r\nconst { parallel, series } = require('gulp');\r\nconst { compile, compileScss, compileJs, compileTs, compileHtml, compileMjml } = require('./compile/compile');\r\nconst { bundle, bundleCss, bundleJs } = require('./bundle/bundle');\r\nconst { copy, copyTask } = require('./copy/copy');\r\nconst { serve } = require('./serve/serve');\r\nconst { watchEntries, setEntry, matchPaths } = require('./watch/watch');\r\n\r\nconst log = require('./logger/logger');\r\nconst { CONFIG_PATH, getConfig } = require('./config/config');\r\nlet config = getConfig();\r\n\r\nconst compileTask = parallel(compileScss, compileJs, compileTs, compileHtml, compileMjml);\r\n\r\nconst compileCssTask = parallel(compileScss);\r\n\r\nconst compileJsTask = parallel(compileJs, compileTs);\r\n\r\nconst bundleTask = parallel(bundleCss, bundleJs);\r\n\r\nfunction watchTask(done, filters) {\r\n\tsetEntry(CONFIG_PATH, CONFIG_PATH);\r\n\twatchEntries((path_, entry) => {\r\n\t\tif (entry === CONFIG_PATH) {\r\n\t\t\tconfig = getConfig();\r\n\t\t\treturn series(compileTask, bundleTask, copyTask);\r\n\t\t}\r\n\t\t// console.log('watchEntries', entry);\r\n\t\tconfig.target.compile.forEach(x => {\r\n\t\t\t// console.log('watchTask', entry, x.input, filters);\r\n\t\t\tif (matchPaths(path_, x.input)) {\r\n\t\t\t\tconst ext = path.extname(path_);\r\n\t\t\t\tif (!filters || filters.indexOf(ext) !== -1) {\r\n\t\t\t\t\tlog('Watch Compile', path_, '>', x.input);\r\n\t\t\t\t\t// console.log('compile', ext, x);\r\n\t\t\t\t\tcompile(x, ext);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\tconfig.target.bundle.forEach(x => {\r\n\t\t\tconst inputs = Array.isArray(x.input) ? x.input : [x.input];\r\n\t\t\tconst item = inputs.find(x => matchPaths(path_, x));\r\n\t\t\tif (item) {\r\n\t\t\t\tconst ext = path.extname(entry);\r\n\t\t\t\tif (!filters || filters.indexOf(ext) !== -1) {\r\n\t\t\t\t\tlog('Watch Bundle', path_, '>', entry);\r\n\t\t\t\t\t// console.log('bundle', ext, x);\r\n\t\t\t\t\tbundle(x, ext);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\t/*\r\n\t\tconfig.target.copy.forEach(x => {\r\n\t\t\tconst inputs = Array.isArray(x.input) ? x.input : [x.input];\r\n\t\t\tconst item = inputs.find(x => matchPaths(path_, x));\r\n\t\t\tif (item) {\r\n\t\t\t\tconst ext = path.extname(entry);\r\n\t\t\t\tif (!filters || filters.indexOf(ext) !== -1) {\r\n\t\t\t\t\tlog('Watch', path_, '>', entry);\r\n\t\t\t\t\t// console.log('copy', ext, x);\r\n\t\t\t\t\tcopy(x, ext, done);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\t*/\r\n\t});\r\n\tdone();\r\n}\r\n\r\nfunction watchCssTask(done) {\r\n\treturn watchTask(done, ['.scss', '.css']);\r\n}\r\n\r\nfunction watchJsTask(done) {\r\n\treturn watchTask(done, ['.js', '.mjs', '.ts', '.tsx']);\r\n}\r\n\r\nexports.compile = compileTask;\r\nexports.bundle = series(bundleTask, copyTask);\r\nexports.watch = watchTask;\r\nexports.serve = serve;\r\nexports.build = series(compileTask, bundleTask, copyTask);\r\nexports.buildCss = series(compileCssTask, bundleCss);\r\nexports.buildCssAndWatch = series(compileCssTask, bundleCss, watchCssTask);\r\nexports.buildJs = series(compileJsTask, bundleJs);\r\nexports.buildJsAndWatch = series(compileJsTask, bundleJs, watchJsTask);\r\nexports.buildAndWatch = series(compileTask, bundleTask, copyTask, watchTask);\r\nexports.buildWatchAndServe = series(compileTask, bundleTask, copyTask, watchTask, serve);\r\n"],"names":["ansyGray","require$$0","colorSupport","require$$1","consoleConsole","require$$2","Console","parseNodeVersion","require$$3","timeStamp","require$$4","nodeVersion","process","version","colorDetectionOptions","ignoreTTY","platform","console","major","stdout","stderr","colorMode","palette","Reset","Bright","Dim","Underscore","Blink","Reverse","Hidden","FgBlack","FgRed","FgGreen","FgYellow","FgBlue","FgMagenta","FgCyan","FgWhite","BgBlack","BgRed","BgGreen","BgYellow","BgBlue","BgMagenta","BgCyan","BgWhite","colors","hasFlag","flag","argv","indexOf","addColor","str","getTimestamp","getLogMessage","items","a","Array","from","concat","apply","map","x","i","length","push","getErrorMessage","log","time","write","arguments","info","dir","warn","error","loggerModule","path","minimatch","watch","entries","cwd","watcher","watchEntries","callback","close","on","path_","matchedEntries","Object","keys","filter","key","imports","isGlob","isExt","sameRoot","isPath","matchPaths","found","find","setTimeout","forEach","entry","setEntry","replace","isArray","p1","ext","extname","p2","dirname","watch_1","fs","getObject","file","objectDefault","objectOverride","object","extendObject","existsSync","text","readFileSync","objectJson","JSON","parse","stripBom","toString","charCodeAt","slice","b","json","extend","require$$5","CONFIG_PATH","options","getOptions","target","service","undefined","o","reduce","p","c","k","v","substr","getTarget","compile","bundle","getConfig","configDefault","targets","browser","dist","server","src","host","port","tfs","config","gulpIf","through2","tfsCheckout","skip","obj","enc","paths","responseError","response","message","tfs_1","nodeSass","vinylSourcemapsApply","require$$7","sass","sync","assign","isNull","isStream","input","basename","contents","replaceExtension","data","indentedSyntax","includePaths","unshift","sourceMap","omitSourceMapUrl","sourceMapContents","filePush","sassObj","sassMap","sassMapFile","sassFileSrc","sassFileSrcPath","sourceFileIndex","relative","sources","source","index","join","css","stats","includedFiles","render","renderSync","filePath","format","name","sass_1","rollup","rollupPluginMjml","vinyl","require$$6","rollupCache","Map","mjml","item","inputOptions","mjmlInput","cache","get","rollupGenerate","output","generate","then","result","out","type","newFilePath","targetFile","newFile","base","stat","isFile","isDirectory","isBlockDevice","isCharacterDevice","isSymbolicLink","isFIFO","isSocket","Buffer","outputs","mjmlOutput","set","Promise","all","results","plugins","keepComments","minify","minifyOptions","collapseWhitespace","minifyCSS","removeEmptyAttributes","beautify","validationLevel","default_","compact","mjml_1","DEFAULT_EXTENSIONS","rollupPluginBabel","babel","rollupPluginCommonJs","rollupPluginSourcemaps","rollupPluginLicense","rollupPluginNodeResolve","rollupPluginTypescript2","require$$8","require$$9","typescript","require$$10","require$$11","require$$12","require$$13","require$$15","rollup_","rollupInput","maps","originalCwd","originalPath","generated","code","rollupOutput","modules","presetEnvOptions","loose","useBuiltIns","esmodules","tsconfigDefaults","compilerOptions","module","lib","allowJs","declaration","removeComments","exclude","tsconfigOverride","globals","externals","external","rollupPluginCommonJsOptions","rollupPluginTypescript2Options","tsconfig","rollupCommonJSResolveHack","clean","check","rollupPluginBabelOptions","extensions","presets","comments","babelHelpers","rollupPluginLicenseOptions","banner","nodeResolve","treeshake","sourcemap","rollup_1","typescript_","typescriptLib","typescriptCompile","typescriptConfig","program","createProgram","fileNames","emitResult","emit","typescriptDiagnostic","getPreEmitDiagnostics","diagnostics","exitCode","emitSkipped","configFileName","typeRoots","strict","configOverride","files","moduleResolution","experimentalDecorators","emitDecoratorMetadata","importHelpers","allowSyntheticDefaultImports","esModuleInterop","outFile","outDir","configFileText","stringify","parseConfigFileTextToJson","configObject","configParseResult","parseJsonConfigFileContent","sys","errors","diagnostic","where","getLineAndCharacterOfPosition","start","fileName","line","character","flattenDiagnosticMessageText","messageText","typescript_1","cssnano","gulpAutoprefixer","gulpConnect","gulpFilter","gulpHtmlExtend","gulpHtmlMin","gulpPlumber","gulpPostcss","gulpRename","gulpTerser","dest","parallel","series","require$$14","require$$16","require$$17","require$$18","require$$19","require$$20","done","task","compileScssItem","compileJsItem","compileTsItem","compileHtmlItem","compileMjmlItem","compileScss","compiles","tasks","allowEmpty","sourcemaps","pipe","__dirname","reload","compileJs","item_","compileRollup","compileTs","output_","compileTypescript","compileHtml","annotations","verbose","compileMjml","args","lastIndexOf","compile_1","gulpConcat","bundleCssItem","bundleJsItem","bundleCss","bundles","bundleJs","bundle_1","copy","copyItemTask","copyTask","copies","split","copy_1","url","serve","root","https","livereload","cert","fallback","middleware","middleware_","logger","rewrites","RegExp","to","context","parsedUrl","pathname","connect","opt","getLogger","req","res","next","headers","accept","method","acceptsHtml","rewriteTarget","rewrite","match","evaluateRewriteRule","charAt","disableDotRule","rule","Error","request","header","htmlAcceptHeaders","bind","serve_1","compileTask","compileCssTask","compileJsTask","bundleTask","watchTask","filters","inputs","watchCssTask","watchJsTask"],"mappings":"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"}
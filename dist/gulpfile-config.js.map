{"version":3,"file":"src/gulpfile-config.js","sources":["../src/logger/logger.js","../src/watch/watch.js","../src/config/json.js","../src/config/config.js","../src/tfs/tfs.js","../src/compile/sass.js","../src/compile/rollup.js","../src/compile/typescript.js","../src/compile/compile.js","../src/bundle/bundle.js","../src/copy/copy.js","../src/serve/serve.js","../src/gulpfile-config.js"],"sourcesContent":["const ansyGray = require('ansi-gray');\nconst colorSupport = require('color-support');\nconst consoleConsole = require('console').Console;\nconst parseNodeVersion = require('parse-node-version');\nconst timeStamp = require('time-stamp');\n\nconst nodeVersion = parseNodeVersion(process.version);\n\nconst colorDetectionOptions = {\n\t// If on Windows, ignore the isTTY check\n\t// This is due to AppVeyor (and thus probably common Windows platforms?) failing the check\n\t// TODO: If this is too broad, we can reduce it to an APPVEYOR env check\n\tignoreTTY: (process.platform === 'win32'),\n};\n\n// Needed to add this because node 10 decided to start coloring log output randomly\nlet console;\nif (nodeVersion.major >= 10) {\n\t// Node 10 also changed the way this is constructed\n\tconsole = new consoleConsole({\n\t\tstdout: process.stdout,\n\t\tstderr: process.stderr,\n\t\tcolorMode: false,\n\t});\n} else {\n\tconsole = new consoleConsole(process.stdout, process.stderr);\n}\n\nconst palette = {\n\tReset: '\\x1b[0m',\n\tBright: '\\x1b[1m',\n\tDim: '\\x1b[2m',\n\tUnderscore: '\\x1b[4m',\n\tBlink: '\\x1b[5m',\n\tReverse: '\\x1b[7m',\n\tHidden: '\\x1b[8m',\n\t//\n\tFgBlack: '\\x1b[30m',\n\tFgRed: '\\x1b[31m',\n\tFgGreen: '\\x1b[32m',\n\tFgYellow: '\\x1b[33m',\n\tFgBlue: '\\x1b[34m',\n\tFgMagenta: '\\x1b[35m',\n\tFgCyan: '\\x1b[36m',\n\tFgWhite: '\\x1b[37m',\n\t//\n\tBgBlack: '\\x1b[40m',\n\tBgRed: '\\x1b[41m',\n\tBgGreen: '\\x1b[42m',\n\tBgYellow: '\\x1b[43m',\n\tBgBlue: '\\x1b[44m',\n\tBgMagenta: '\\x1b[45m',\n\tBgCyan: '\\x1b[46m',\n\tBgWhite: '\\x1b[47m',\n};\n\nconst colors = [palette.FgWhite, palette.FgCyan, palette.FgGreen, palette.FgYellow, palette.FgMagenta, palette.FgBlue];\n\nfunction hasFlag(flag) {\n\treturn (process.argv.indexOf('--' + flag) !== -1);\n}\n\nfunction addColor(str) {\n\tif (hasFlag('no-color')) {\n\t\treturn str;\n\t}\n\n\tif (hasFlag('color')) {\n\t\treturn ansyGray(str);\n\t}\n\n\tif (colorSupport(colorDetectionOptions)) {\n\t\treturn ansyGray(str);\n\t}\n\n\treturn str;\n}\n\nfunction getTimestamp() {\n\treturn '[' + addColor(timeStamp('HH:mm:ss')) + ']';\n}\n\nfunction getLogMessage(items) {\n\tlet a = Array.from(items);\n\ta = [].concat.apply([], (a.map((x, i) => [colors[i % colors.length], x])));\n\ta.push(palette.Reset);\n\treturn a;\n}\n\nfunction getErrorMessage(items) {\n\tlet a = Array.from(items);\n\ta = [].concat.apply([], (a.map((x, i) => [palette.FgRed, x])));\n\ta.push(palette.Reset);\n\treturn a;\n}\n\nfunction log() {\n\tconst time = getTimestamp();\n\tprocess.stdout.write(time + ' ');\n\tconsole.log.apply(console, getLogMessage(arguments));\n\treturn this;\n}\n\nfunction info() {\n\tconst time = getTimestamp();\n\tprocess.stdout.write(time + ' ');\n\tconsole.info.apply(console, getLogMessage(arguments));\n\treturn this;\n}\n\nfunction dir() {\n\tconst time = getTimestamp();\n\tprocess.stdout.write(time + ' ');\n\tconsole.dir.apply(console, getLogMessage(arguments));\n\treturn this;\n}\n\nfunction warn() {\n\tconst time = getTimestamp();\n\tprocess.stderr.write(time + ' ');\n\tconsole.warn.apply(console, getLogMessage(arguments));\n\treturn this;\n}\n\nfunction error() {\n\tconst time = getTimestamp();\n\tprocess.stderr.write(time + ' ');\n\tconsole.error.apply(console, getErrorMessage(arguments));\n\treturn this;\n}\n\nmodule.exports = log;\nmodule.exports.info = info;\nmodule.exports.dir = dir;\nmodule.exports.warn = warn;\nmodule.exports.error = error;\n","const path = require('path');\nconst { watch } = require('gulp');\n\nconst log = require('../logger/logger');\nconst entries = {};\nconst cwd = process.cwd();\n\nfunction setEntry(entry, imports) {\n\t// console.log(entry, imports);\n\tentry = entry.replace(cwd, '');\n\tif (typeof imports === 'string') {\n\t\t//\n\t\tentries[entry] = imports;\n\t} else if (imports) {\n\t\timports = Array.isArray(imports) ? imports : [imports];\n\t\timports = imports.map(x => x.replace(cwd, ''));\n\t\tentries[entry] = imports;\n\t}\n\t// log('watch', entry, imports);\n}\n\nlet watcher;\n\nfunction watchEntries(callback) {\n\tif (watcher && typeof watcher.close === 'function') {\n\t\twatcher.close();\n\t}\n\tlet complete;\n\twatcher = watch(['**/*.*', '!node_modules/**/*.*'], function watch(done) {\n\t\tcomplete = done;\n\t\t// console.log('done');\n\t}).on('change', (path_) => {\n\t\tconst entry = Object.keys(entries).reduce((p, key) => {\n\t\t\tconst imports = entries[key];\n\t\t\tif (isGlob(key)) {\n\t\t\t\tif (isExt(path_, imports) && sameRoot(path_, key)) {\n\t\t\t\t\treturn key;\n\t\t\t\t} else {\n\t\t\t\t\treturn p;\n\t\t\t\t}\n\t\t\t} else if (isPath(imports)) {\n\t\t\t\tif (key.indexOf(path_) !== -1) {\n\t\t\t\t\treturn key;\n\t\t\t\t} else {\n\t\t\t\t\treturn p;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst found = imports.find(i => {\n\t\t\t\t\t// console.log(i, path_);\n\t\t\t\t\treturn i.indexOf(path_) !== -1;\n\t\t\t\t}) || key.indexOf(path_) !== -1;\n\t\t\t\tif (found) {\n\t\t\t\t\treturn key;\n\t\t\t\t} else {\n\t\t\t\t\treturn p;\n\t\t\t\t}\n\t\t\t}\n\t\t}, null);\n\t\tif (entry) {\n\t\t\t// console.log('entry', entry);\n\t\t\t// log('watch.changed', path_, '>', entry);\n\t\t\tif (typeof callback === 'function') {\n\t\t\t\tcallback(path_, entry, complete);\n\t\t\t}\n\t\t} else {\n\t\t\tif (typeof complete === 'function') {\n\t\t\t\treturn complete();\n\t\t\t}\n\t\t\t// console.log('change');\n\t\t}\n\t});\n}\n\nfunction isGlob(path) {\n\treturn typeof path === 'string' && path.indexOf('*') !== -1;\n}\n\nfunction isPath(path) {\n\treturn typeof path === 'string' && path.indexOf('*') === -1;\n}\n\nfunction isExt(p1, ext) {\n\treturn path.extname(p1) === ext;\n}\n\nfunction sameRoot(p1, p2) {\n\treturn path.dirname(p1).indexOf(path.dirname(p2)) === 0;\n}\n\nmodule.exports = {\n\tsetEntry,\n\twatchEntries\n};\n","const fs = require('fs'),\n\tpath = require('path'),\n\tprocess = require('process');\n\nconst log = require('../logger/logger');\n\nfunction getObject(file, objectDefault = {}, objectOverride = {}) {\n\tlet object = extendObject({}, objectDefault);\n\tif (fs.existsSync(file)) {\n\t\tconst text = fs.readFileSync(file, 'utf8');\n\t\tconst objectJson = JSON.parse(stripBom(text));\n\t\tobject = extendObject(object, objectJson);\n\t} else {\n\t\tlog.warn(`missing ${file}`);\n\t}\n\tobject = extendObject(object, objectOverride);\n\treturn object;\n}\n\nfunction stripBom(text) {\n\ttext = text.toString();\n\tif (text.charCodeAt(0) === 0xFEFF) {\n\t\ttext = text.slice(1);\n\t}\n\treturn text;\n}\n\nfunction extendObject(a, b) {\n\tif (typeof a === 'object') {\n\t\tfor (let key in b) {\n\t\t\tif (typeof a[key] === 'object' && typeof b[key] === 'object') {\n\t\t\t\ta[key] = extendObject(a[key], b[key]);\n\t\t\t} else {\n\t\t\t\ta[key] = b[key];\n\t\t\t}\n\t\t}\n\t\treturn a;\n\t} else {\n\t\treturn b;\n\t}\n}\n\nmodule.exports = {\n\tgetObject,\n\textend: extendObject,\n};\n","const fs = require('fs'),\n\tpath = require('path'),\n\tprocess = require('process');\n\nconst { watch } = require('gulp');\n\nconst log = require('../logger/logger');\n\nconst { getObject, extend } = require('./json');\n\nconst CONFIG_PATH = './gulpfile-config.json';\nconst options = getOptions();\nconst target = options.target || 'browser';\n\nconst service = {\n\toptions,\n};\n\nfunction getOptions() {\n\tlet key = undefined;\n\tconst o = process.argv.reduce((p, c, a) => {\n\t\tlet k, v;\n\t\tif (c.indexOf('--') === 0) {\n\t\t\tk = c.substr(2);\n\t\t} else {\n\t\t\tv = c;\n\t\t}\n\t\tif (key) {\n\t\t\tp[key] = (v === undefined ? true : v);\n\t\t\tkey = undefined;\n\t\t}\n\t\tkey = k;\n\t\treturn p;\n\t}, {});\n\tif (key) {\n\t\to[key] = true;\n\t}\n\treturn o;\n}\n\nfunction getTarget() {\n\treturn {\n\t\tcompile: [],\n\t\tbundle: [],\n\t};\n}\n\nfunction getConfig() {\n\tlet configDefault = {\n\t\ttargets: {\n\t\t\tbrowser: getTarget(),\n\t\t\tdist: getTarget()\n\t\t},\n\t\tserver: {\n\t\t\tsrc: './docs',\n\t\t\tpath: '/gulpfile-config/',\n\t\t\thost: 'localhost',\n\t\t\tport: 40900\n\t\t},\n\t\ttfs: false\n\t};\n\tconst config = getObject(CONFIG_PATH, configDefault);\n\tconfig.target = config.targets[target] || getTarget();\n\tservice.target = target;\n\tservice.config = config.target;\n\tservice.config.server = config.server;\n\tservice.config.tfs = config.tfs;\n\treturn config;\n}\n\n/*\nfunction configWatcher(callback) {\n\tconst configWatch = watch(CONFIG_PATH, function config(done) {\n\t\t// config = getConfig();\n\t\tif (typeof callback === 'function') {\n\t\t\treturn callback(done);\n\t\t}\n\t}).on('change', logWatch);\n\treturn [configWatch];\n}\n\nfunction logWatch(path, stats) {\n\tlog('Changed', path);\n}\n*/\n\nmodule.exports = {\n\tCONFIG_PATH,\n\tgetConfig: getConfig,\n\ttarget: target,\n\tservice: service,\n};\n","const fs = require('fs'),\n\tgulpIf = require('gulp-if'),\n\ttfs = require('tfs'),\n\tthrough2 = require('through2');\n\nconst log = require('../logger/logger');\nconst { service } = require('../config/config');\n\nfunction tfsCheckout(skip) {\n\treturn gulpIf(!skip && service.config.tfs, through2.obj((file, enc, callback) => {\n\t\t// console.log('TfsCheckout', file.path);\n\t\tif (fs.existsSync(file.path)) {\n\t\t\tconst paths = [file.path];\n\t\t\tif (fs.existsSync(file.path + '.map')) {\n\t\t\t\tpaths.push(file.path + '.map');\n\t\t\t}\n\t\t\ttfs('checkout', paths, null, (responseError, response) => {\n\t\t\t\tcallback(null, file);\n\t\t\t\tif (responseError) {\n\t\t\t\t\tconsole.error(responseError.error);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tlog('Checkout', file.path, response.message);\n\t\t\t});\n\t\t} else {\n\t\t\tcallback(null, file);\n\t\t}\n\t}));\n}\n\nmodule.exports = tfsCheckout;\n","const nodeSass = require('node-sass'),\n\tpath = require('path'),\n\tthrough2 = require('through2'),\n\tvinyl = require('vinyl'),\n\tvinylSourcemapsApply = require('vinyl-sourcemaps-apply');\n\nconst log = require('../logger/logger');\nconst { service } = require('../config/config');\n\nconst { setEntry } = require('../watch/watch');\n\nfunction sass(options, sync) {\n\toptions = Object.assign({}, options);\n\treturn through2.obj(function(file, enc, callback) { // eslint-disable-line consistent-return\n\t\tif (file.isNull()) {\n\t\t\treturn callback(null, file);\n\t\t}\n\t\tif (file.isStream()) {\n\t\t\tlog.error('sass', 'streaming not supported');\n\t\t\treturn callback(null, file);\n\t\t}\n\t\tconst input = file.path;\n\t\tif (path.basename(file.path).indexOf('_') === 0) {\n\t\t\treturn callback();\n\t\t}\n\t\tif (!file.contents.length) {\n\t\t\tfile.path = replaceExtension(file.path, '.css'); // eslint-disable-line no-param-reassign\n\t\t\treturn callback(null, file);\n\t\t}\n\t\toptions.data = file.contents.toString();\n\t\t// we set the file path here so that libsass can correctly resolve import paths\n\t\toptions.file = file.path;\n\t\t// Ensure `indentedSyntax` is true if a `.sass` file\n\t\tif (path.extname(file.path) === '.sass') {\n\t\t\toptions.indentedSyntax = true;\n\t\t}\n\t\t// Ensure file's parent directory in the include path\n\t\tif (options.includePaths) {\n\t\t\tif (typeof options.includePaths === 'string') {\n\t\t\t\toptions.includePaths = [options.includePaths];\n\t\t\t}\n\t\t} else {\n\t\t\toptions.includePaths = [];\n\t\t}\n\t\toptions.includePaths.unshift(path.dirname(file.path));\n\t\t// Generate Source Maps if plugin source-map present\n\t\tif (file.sourceMap) {\n\t\t\toptions.sourceMap = file.path;\n\t\t\toptions.omitSourceMapUrl = true;\n\t\t\toptions.sourceMapContents = true;\n\t\t}\n\t\tconst filePush = (sassObj) => {\n\t\t\tlet sassMap;\n\t\t\tlet sassMapFile;\n\t\t\tlet sassFileSrc;\n\t\t\tlet sassFileSrcPath;\n\t\t\tlet sourceFileIndex;\n\t\t\t// Build Source Maps!\n\t\t\tif (sassObj.map) {\n\t\t\t\t// Transform map into JSON\n\t\t\t\tsassMap = JSON.parse(sassObj.map.toString());\n\t\t\t\t// Grab the stdout and transform it into stdin\n\t\t\t\tsassMapFile = sassMap.file.replace(/^stdout$/, 'stdin');\n\t\t\t\t// Grab the base file name that's being worked on\n\t\t\t\tsassFileSrc = file.relative;\n\t\t\t\t// Grab the path portion of the file that's being worked on\n\t\t\t\tsassFileSrcPath = path.dirname(sassFileSrc);\n\t\t\t\tif (sassFileSrcPath) {\n\t\t\t\t\t// Prepend the path to all files in the sources array except the file that's being worked on\n\t\t\t\t\tsourceFileIndex = sassMap.sources.indexOf(sassMapFile);\n\t\t\t\t\tsassMap.sources = sassMap.sources.map((source, index) => { // eslint-disable-line arrow-body-style\n\t\t\t\t\t\treturn index === sourceFileIndex ? source : path.join(sassFileSrcPath, source);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\t// Remove 'stdin' from souces and replace with filenames!\n\t\t\t\tsassMap.sources = sassMap.sources.filter(src => src !== 'stdin' && src);\n\t\t\t\t// Replace the map file with the original file name (but new extension)\n\t\t\t\tsassMap.file = replaceExtension(sassFileSrc, '.css');\n\t\t\t\t// Apply the map\n\t\t\t\tvinylSourcemapsApply(file, sassMap);\n\t\t\t}\n\t\t\tfile.contents = sassObj.css; // eslint-disable-line no-param-reassign\n\t\t\tfile.path = replaceExtension(file.path, '.css'); // eslint-disable-line no-param-reassign\n\t\t\tcallback(null, file);\n\t\t};\n\t\tif (sync !== true) {\n\t\t\tconst callback = (error, object) => { // eslint-disable-line consistent-return\n\t\t\t\tif (error) {\n\t\t\t\t\treturn log.error('sass', error);\n\t\t\t\t\t// return callback(null, null);\n\t\t\t\t}\n\t\t\t\tsetEntry(input, object.stats.includedFiles);\n\t\t\t\tfilePush(object);\n\t\t\t};\n\t\t\tnodeSass.render(options, callback);\n\t\t} else {\n\t\t\ttry {\n\t\t\t\tconst object = nodeSass.renderSync(options);\n\t\t\t\tsetEntry(input, object.stats.includedFiles);\n\t\t\t\tfilePush(object);\n\t\t\t} catch (error) {\n\t\t\t\treturn log.error('sass', error);\n\t\t\t\t// return callback(null, null);\n\t\t\t}\n\t\t}\n\t});\n}\n\nsass.sync = (options) => sass(options, true);\n\nfunction replaceExtension(filePath, ext) {\n\tfilePath = path.format({\n\t\tdir: path.dirname(filePath),\n\t\tname: path.basename(filePath, path.extname(filePath)),\n\t\text,\n\t});\n\treturn filePath;\n}\n\n/*\n\nconst errorM = (error) => {\n\tconst filePath = (error.file === 'stdin' ? file.path : error.file) || file.path;\n\tconst relativePath = path.relative(process.cwd(), filePath);\n\tconst message = [chalk.underline(relativePath), error.formatted].join('\\n');\n\n\terror.messageFormatted = message; // eslint-disable-line no-param-reassign\n\terror.messageOriginal = error.message; // eslint-disable-line no-param-reassign\n\terror.message = stripAnsi(message); // eslint-disable-line no-param-reassign\n\terror.relativePath = relativePath; // eslint-disable-line no-param-reassign\n\n\treturn callback(new pluginError('sass', error));\n};\n\nsass.logError = function logError(error) {\n\tconst message = new pluginError('sass', error.messageFormatted).toString();\n\tprocess.stderr.write(`${message}\\n`);\n\tthis.emit('end');\n};\n*/\n\nmodule.exports = {\n\tsass\n};\n","const { DEFAULT_EXTENSIONS } = require('@babel/core'),\n\tpath = require('path'),\n\trollup = require('rollup'),\n\trollupPluginBabel = require('rollup-plugin-babel'),\n\trollupPluginCommonJs = require('@rollup/plugin-commonjs'),\n\trollupPluginSourcemaps = require('rollup-plugin-sourcemaps'),\n\trollupPluginLicense = require('rollup-plugin-license'),\n\t// rollupPluginNodeResolve = require('@rollup/plugin-node-resolve'),\n\trollupPluginTypescript2 = require('rollup-plugin-typescript2'),\n\t// rollupPluginTypescript = require('@rollup/plugin-typescript'),\n\tthrough2 = require('through2'),\n\ttypescript = require('typescript'),\n\tvinyl = require('vinyl'),\n\tvinylSourcemapsApply = require('vinyl-sourcemaps-apply');\n\nconst log = require('../logger/logger');\nconst { service } = require('../config/config');\n\nconst { setEntry } = require('../watch/watch');\n\n// map object storing rollup cache objects for each input file\nlet rollupCache = new Map();\n\nfunction rollup_(item) {\n\treturn through2.obj(function(file, enc, callback) {\n\t\tif (file.isNull()) {\n\t\t\treturn callback(null, file);\n\t\t}\n\t\tif (file.isStream()) {\n\t\t\tlog.error('rollup', 'streaming not supported');\n\t\t\treturn callback(null, file);\n\t\t}\n\t\tconst inputOptions = rollupInput(item);\n\t\t// caching is enabled by default because of the nature of gulp and the watching/recompilatin\n\t\t// but can be disabled by setting 'cache' to false\n\t\tif (inputOptions.cache !== false) {\n\t\t\tinputOptions.cache = rollupCache.get(inputOptions.input);\n\t\t}\n\t\tconst maps = file.sourceMap !== undefined;\n\t\tconst originalCwd = file.cwd;\n\t\tconst originalPath = file.path;\n\t\tconst rollupGenerate = (bundle, output, i) => {\n\t\t\treturn bundle.generate(output).then(result => {\n\t\t\t\tif (!result) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconst newFileName = path.basename(output.file);\n\t\t\t\tconst newFilePath = output.file;\n\t\t\t\tlet targetFile;\n\t\t\t\tif (i > 0) {\n\t\t\t\t\tconst newFile = new vinyl({\n\t\t\t\t\t\tcwd: file.cwd,\n\t\t\t\t\t\tbase: file.base,\n\t\t\t\t\t\tpath: newFilePath,\n\t\t\t\t\t\tstat: {\n\t\t\t\t\t\t\tisFile: () => true,\n\t\t\t\t\t\t\tisDirectory: () => false,\n\t\t\t\t\t\t\tisBlockDevice: () => false,\n\t\t\t\t\t\t\tisCharacterDevice: () => false,\n\t\t\t\t\t\t\tisSymbolicLink: () => false,\n\t\t\t\t\t\t\tisFIFO: () => false,\n\t\t\t\t\t\t\tisSocket: () => false\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\ttargetFile = newFile;\n\t\t\t\t} else {\n\t\t\t\t\tfile.path = newFilePath;\n\t\t\t\t\ttargetFile = file;\n\t\t\t\t}\n\t\t\t\tconst generated = result.output[0];\n\t\t\t\t// Pass sourcemap content and metadata to gulp-sourcemaps plugin to handle\n\t\t\t\t// destination (and custom name) was given, possibly multiple output bundles.\n\t\t\t\tif (maps) {\n\t\t\t\t\tgenerated.map.file = path.relative(originalCwd, originalPath);\n\t\t\t\t\tgenerated.map.sources = generated.map.sources.map(source => path.relative(originalCwd, source));\n\t\t\t\t}\n\t\t\t\t// console.log(generated.map.file);\n\t\t\t\t// return bundled file as buffer\n\t\t\t\ttargetFile.contents = Buffer.from(generated.code);\n\t\t\t\t// apply sourcemap to output file\n\t\t\t\tif (maps) {\n\t\t\t\t\tvinylSourcemapsApply(targetFile, generated.map);\n\t\t\t\t}\n\t\t\t\tif (i > 0) {\n\t\t\t\t\tthis.push(targetFile);\n\t\t\t\t}\n\t\t\t\treturn result;\n\t\t\t}).catch(error => {\n\t\t\t\tlog.error('rollup', error);\n\t\t\t});\n\t\t};\n\n\t\trollup.rollup(inputOptions).then(bundle => {\n\t\t\t\t// console.log(bundle);\n\t\t\t\tconst outputs = rollupOutput(item);\n\t\t\t\t// console.log(outputs);\n\t\t\t\tif (inputOptions.cache !== false) {\n\t\t\t\t\trollupCache.set(inputOptions.input, bundle);\n\t\t\t\t}\n\t\t\t\treturn Promise.all(outputs.map((output, i) => rollupGenerate(bundle, output, i)));\n\t\t\t\t// return bundle.write(outputs);\n\t\t\t})\n\t\t\t.then((results) => {\n\t\t\t\tresults.forEach(x => {\n\t\t\t\t\tconst outputs = x.output;\n\t\t\t\t\toutputs.forEach(x => {\n\t\t\t\t\t\tsetEntry(inputOptions.input, Object.keys(x.modules));\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t\tcallback(null, file); // pass file to gulp and end stream\n\t\t\t})\n\t\t\t.catch(error => {\n\t\t\t\tlog.error('rollup', error);\n\t\t\t\tif (inputOptions.cache !== false) {\n\t\t\t\t\trollupCache.delete(inputOptions.input);\n\t\t\t\t}\n\t\t\t\tthrow (error);\n\t\t\t\treturn callback(null, file);\n\t\t\t});\n\t});\n}\n\nfunction rollupInput(item) {\n\tconst presetEnvOptions = {\n\t\tmodules: false,\n\t\tloose: true,\n\t};\n\tif ((typeof item.output === 'object' && item.output.format === 'esm') || item.target === 'esm') {\n\t\tpresetEnvOptions.targets = {\n\t\t\tesmodules: true\n\t\t};\n\t} else {\n\t\tif (item.target) {\n\t\t\tpresetEnvOptions.targets = item.target; // || 'last 2 version, ie 11'; // readed from .browserslistrc\n\t\t}\n\t}\n\t// console.log(item.output.file, item.output, item.target, presetEnvOptions);\n\tconst tsconfigDefaults = {\n\t\tcompilerOptions: {\n\t\t\ttarget: 'esNext',\n\t\t\tmodule: 'esNext',\n\t\t\tlib: ['dom', 'es2015', 'es2016', 'es2017'],\n\t\t\tallowJs: true,\n\t\t\tdeclaration: false,\n\t\t\tsourceMap: true,\n\t\t\tremoveComments: true,\n\t\t},\n\t\texclude: [\n\t\t\t'./node_modules/*',\n\t\t\t'.npm'\n\t\t]\n\t};\n\tconst tsconfigOverride = {\n\t\tcompilerOptions: {\n\t\t\ttarget: 'esNext',\n\t\t\tmodule: 'esNext',\n\t\t\tlib: ['dom', 'es2015', 'es2016', 'es2017'],\n\t\t\tallowJs: true,\n\t\t\tdeclaration: false,\n\t\t\tsourceMap: true,\n\t\t\tremoveComments: true,\n\t\t},\n\t\texclude: [\n\t\t\t'./node_modules/*',\n\t\t\t'.npm'\n\t\t]\n\t};\n\t// const watchGlob = path.dirname(input) + '/**/*' + path.extname(input);\n\t// console.log('watchGlob', watchGlob);\n\tconst plugins = [\n\t\t// Resolve source maps to the original source\n\t\trollupPluginSourcemaps(),\n\t\t/*\n\t\t// Allow node_modules resolution, so you can use 'external' to control\n\t\t// which external modules to include in the bundle\n\t\t// https://github.com/rollup/rollup-plugin-node-resolve#usage\n\t\t// import node modules\n\t\trollupPluginNodeResolve(),\n\t\t*/\n\t\t// Allow bundling cjs modules (unlike webpack, rollup doesn't understand cjs)\n\t\trollupPluginCommonJs({\n\t\t\texclude: ['node_modules/**'],\n\t\t}),\n\t\t// Compile TypeScript files\n\t\tpath.extname(item.input) === '.ts' ? rollupPluginTypescript2({\n\t\t\ttypescript: typescript,\n\t\t\ttsconfigDefaults: tsconfigDefaults,\n\t\t\ttsconfig: 'tsconfig.json',\n\t\t\ttsconfigOverride: tsconfigOverride,\n\t\t\trollupCommonJSResolveHack: true,\n\t\t\tclean: true,\n\t\t\tcheck: false,\n\t\t}) : null,\n\t\trollupPluginBabel({\n\t\t\textensions: [\n\t\t\t\t...DEFAULT_EXTENSIONS,\n\t\t\t\t'.ts',\n\t\t\t\t'.tsx'\n\t\t\t],\n\t\t\tpresets: [\n\t\t\t\t['@babel/preset-env', presetEnvOptions],\n\t\t\t\t// ['@babel/preset-typescript', { modules: false, loose: true }]\n\t\t\t],\n\t\t\tplugins: [\n\t\t\t\t'@babel/plugin-proposal-class-properties',\n\t\t\t\t'@babel/plugin-proposal-object-rest-spread'\n\t\t\t],\n\t\t\texclude: 'node_modules/**', // only transpile our source code\n\t\t\tcomments: false,\n\t\t\t// babelHelpers: 'bundled', // only for version 5\n\t\t\t// babelrc: false,\n\t\t}),\n\t\trollupPluginLicense({\n\t\t\tbanner: `@license <%= pkg.name %> v<%= pkg.version %>\n\t\t\t(c) <%= moment().format('YYYY') %> <%= pkg.author %>\n\t\t\tLicense: <%= pkg.license %>`,\n\t\t}),\n\n\t].filter(x => x);\n\tconst input = {\n\t\tinput: item.input,\n\t\tplugins: plugins,\n\t\texternal: item.external || [],\n\t\tcache: false, // !! break babel if true\n\t\ttreeshake: true,\n\t\t/*\n\t\twatch: {\n\t\t\tinclude: watchGlob,\n\t\t},\n\t\t*/\n\t};\n\treturn input;\n}\n\nfunction rollupOutput(item) {\n\tconst input = item.input;\n\tconst output = item.output;\n\tconst outputs = Array.isArray(output) ? output : [output];\n\tconst default_ = {\n\t\tformat: 'iife',\n\t\tname: item.name || null,\n\t\tglobals: (typeof output === 'object' && output.globals) || item.globals || {},\n\t\tsourcemap: true,\n\t\tminify: item.minify || false,\n\t};\n\treturn outputs.map(x => {\n\t\tlet output = Object.assign({}, default_);\n\t\tif (typeof x === 'string') {\n\t\t\toutput.file = x;\n\t\t} else if (typeof x === 'object') {\n\t\t\toutput = Object.assign(output, x);\n\t\t}\n\t\toutput.name = output.name || path.basename(output.file, '.js');\n\t\treturn output;\n\t});\n}\n\nmodule.exports = {\n\trollup: rollup_,\n\trollupInput,\n\trollupOutput,\n};\n","const typescript = require('typescript'),\n\tfs = require('fs'),\n\tpath = require('path'),\n\tprocess = require('process'),\n\trollupPluginCommonJs = require('@rollup/plugin-commonjs'),\n\trollupPluginSourcemaps = require('rollup-plugin-sourcemaps'),\n\trollupPluginLicense = require('rollup-plugin-license'),\n\trollupPluginTypescript2 = require('rollup-plugin-typescript2'),\n\tthrough2 = require('through2'),\n\tvinyl = require('vinyl'),\n\tvinylSourcemapsApply = require('vinyl-sourcemaps-apply');\n\nconst log = require('../logger/logger');\nconst { service } = require('../config/config');\nconst { getObject, extend } = require('../config/json');\n\nconst { rollup, rollupInput, rollupOutput } = require('./rollup');\n\n/*\nconst RollupFormats = {\n\t'amd': 'amd', // Asynchronous Module Definition, used with module loaders like RequireJS\n\t'cjs': 'cjs', // CommonJS, suitable for Node and other bundlers\n\t'esm': 'esm', // Keep the bundle as an ES module file, suitable for other bundlers and inclusion as a <script type=module> tag in modern browsers\n\t'iife': 'iife', // A self-executing function, suitable for inclusion as a <script> tag. (If you want to create a bundle for your application, you probably want to use this.)\n\t'umd': 'umd', // Universal Module Definition, works as amd, cjs and iife all in one\n\t'system': 'system', // Native format of the SystemJS loader\n};\n\nconst TypescriptTarget = [\"ES3\", \"ES5\", \"ES6\", \"ES2015\", \"ES2016\", \"ES2017\", \"ES2018\", \"ES2019\", \"ES2020\", \"ESNext\"];\nconst TypescriptModule = [\"CommonJS\", \"AMD\", \"System\", \"UMD\", \"ES6\", \"ES2015\", \"ESNext\", \"None\"];\n*/\n\n// compile('tsconfig.json');\n\nfunction typescript_(item) {\n\tconst output = typescriptOutput(item)[0];\n\tswitch (output.format) {\n\t\tcase 'iife':\n\t\tcase 'umd':\n\t\t\treturn rollup(item);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\treturn typescriptLib(item, output);\n\t}\n\t/*\n\t'iife': 'iife', // A self-executing function, suitable for inclusion as a <script> tag. (If you want to create a bundle for your application, you probably want to use this.)\n\t'umd': 'umd', // Universal Module Definition, works as amd, cjs and iife all in one\n\n\t'amd': 'amd', // Asynchronous Module Definition, used with module loaders like RequireJS\n\t'cjs': 'cjs', // CommonJS, suitable for Node and other bundlers\n\t'esm': 'esm', // Keep the bundle as an ES module file, suitable for other bundlers and inclusion as a <script type=module> tag in modern browsers\n\t'system': 'system', // Native format of the SystemJS loader\n\t*/\n}\n\nfunction typescriptLib(item, output) {\n\treturn through2.obj(function(file, enc, callback) {\n\t\t// console.log('TfsCheckout', file.path);\n\t\tif (file.isNull()) {\n\t\t\treturn callback(null, file);\n\t\t}\n\t\tif (file.isStream()) {\n\t\t\tconsole.warn('Rollup, Streaming not supported');\n\t\t\treturn callback(null, file);\n\t\t}\n\t\tconst result = typescriptCompile(file, item, output);\n\t\treturn callback(null, file);\n\t});\n}\n\nfunction typescriptCompile(file, item) {\n\t// Extract configuration from config file\n\tconst config = typescriptConfig(item);\n\t// console.log('fileNames', config.fileNames);\n\t// console.log('options', config.options);\n\n\t// return 0;\n\tconst program = typescript.createProgram(config.fileNames, config.options);\n\tconst emitResult = program.emit();\n\t// console.log('emitResult', emitResult);\n\n\t// Report errors\n\ttypescriptDiagnostic(typescript.getPreEmitDiagnostics(program).concat(emitResult.diagnostics));\n\n\t// Return code\n\tconst exitCode = emitResult.emitSkipped ? 1 : 0;\n\t// console.log('exitCode', exitCode);\n\treturn exitCode;\n\tprocess.exit(exitCode);\n}\n\nfunction typescriptConfig(item) {\n\n\tconst configFileName = 'tsconfig.json';\n\n\tconst configDefault = {\n\t\tcompilerOptions: {\n\t\t\ttypeRoots: ['node_modules/@types'],\n\t\t\tstrict: false\n\t\t}\n\t};\n\t/*\n\t\"baseUrl\": \"\",\n\t\"mapRoot\": \"./\",\n\t*/\n\n\tlet configOverride = {\n\t\tfiles: [item.input],\n\t\tcompilerOptions: {\n\t\t\tmoduleResolution: 'node',\n\t\t\texperimentalDecorators: true,\n\t\t\temitDecoratorMetadata: true,\n\t\t\tremoveComments: true,\n\t\t\timportHelpers: true,\n\t\t\tallowSyntheticDefaultImports: true,\n\t\t\tesModuleInterop: true,\n\t\t\tallowJs: true,\n\t\t},\n\t\texclude: [\n\t\t\t'node_modules',\n\t\t\t'.npm'\n\t\t]\n\t};\n\n\tconst output = typescriptOutput(item)[0];\n\t// console.log(output);\n\tswitch (output.format) {\n\t\tcase 'amd':\n\t\t\tconfigOverride = extend(configOverride, {\n\t\t\t\tcompilerOptions: {\n\t\t\t\t\ttarget: 'es5',\n\t\t\t\t\tmodule: 'amd',\n\t\t\t\t\toutFile: output.file,\n\t\t\t\t\tlib: ['dom', 'es2015', 'es2016', 'es2017'],\n\t\t\t\t\tdeclaration: false,\n\t\t\t\t\tsourceMap: true,\n\t\t\t\t}\n\t\t\t});\n\t\t\tbreak;\n\t\tcase 'cjs':\n\t\t\tconfigOverride = extend(configOverride, {\n\t\t\t\tcompilerOptions: {\n\t\t\t\t\ttarget: 'es5',\n\t\t\t\t\tmodule: 'commonJS',\n\t\t\t\t\toutDir: output.file,\n\t\t\t\t\tlib: ['dom', 'es2015', 'es2016', 'es2017'],\n\t\t\t\t\tdeclaration: true,\n\t\t\t\t\tsourceMap: false,\n\t\t\t\t}\n\t\t\t});\n\t\t\tbreak;\n\t\tcase 'esm':\n\t\t\tconfigOverride = extend(configOverride, {\n\t\t\t\tcompilerOptions: {\n\t\t\t\t\ttarget: 'es2015',\n\t\t\t\t\tmodule: 'es6',\n\t\t\t\t\toutDir: output.file,\n\t\t\t\t\tlib: ['dom', 'es2015', 'es2016', 'es2017'],\n\t\t\t\t\tdeclaration: true,\n\t\t\t\t\tsourceMap: false,\n\t\t\t\t}\n\t\t\t});\n\t\t\tbreak;\n\t\tcase 'system':\n\t\t\tconfigOverride = extend(configOverride, {\n\t\t\t\tcompilerOptions: {\n\t\t\t\t\ttarget: 'es5',\n\t\t\t\t\tmodule: 'system',\n\t\t\t\t\toutFile: output.file,\n\t\t\t\t\tlib: ['dom', 'es2015', 'es2016', 'es2017'],\n\t\t\t\t\tdeclaration: false,\n\t\t\t\t\tsourceMap: true,\n\t\t\t\t}\n\t\t\t});\n\t\t\tbreak;\n\t}\n\n\t/*\n\t'amd': 'amd', // Asynchronous Module Definition, used with module loaders like RequireJS\n\t'cjs': 'cjs', // CommonJS, suitable for Node and other bundlers\n\t'esm': 'esm', // Keep the bundle as an ES module file, suitable for other bundlers and inclusion as a <script type=module> tag in modern browsers\n\t'system': 'system', // Native format of the SystemJS loader\n\t*/\n\n\tconst config = getObject(`./${configFileName}`, configDefault, configOverride);\n\n\tconst configFileText = JSON.stringify(config);\n\n\t// Parse JSON, after removing comments. Just fancier JSON.parse\n\tconst result = typescript.parseConfigFileTextToJson(configFileName, configFileText);\n\tconst configObject = result.config;\n\tif (!configObject) {\n\t\ttypescriptDiagnostic([result.error]);\n\t\treturn;\n\t\tprocess.exit(1);\n\t}\n\n\t// Extract config infromation\n\tconst configParseResult = typescript.parseJsonConfigFileContent(configObject, typescript.sys, path.dirname(configFileName));\n\tif (configParseResult.errors.length > 0) {\n\t\ttypescriptDiagnostic(configParseResult.errors);\n\t\treturn;\n\t\tprocess.exit(1);\n\t}\n\treturn configParseResult;\n}\n\nfunction typescriptDiagnostic(diagnostics) {\n\tdiagnostics.forEach(diagnostic => {\n\t\tlet message = 'Error';\n\t\tif (diagnostic.file) {\n\t\t\tconst where = diagnostic.file.getLineAndCharacterOfPosition(diagnostic.start);\n\t\t\tmessage += ' ' + diagnostic.file.fileName + ' ' + where.line + ', ' + where.character + 1;\n\t\t}\n\t\tmessage += ': ' + typescript.flattenDiagnosticMessageText(diagnostic.messageText, '\\n');\n\t\tconsole.log(message);\n\t});\n}\n\nfunction typescriptInput(item) {\n\t// const watchGlob = path.dirname(item.input) + '/**/*' + path.extname(item.input);\n\t// console.log('watchGlob', watchGlob);\n\tconst plugins = [\n\t\t// Resolve source maps to the original source\n\t\trollupPluginSourcemaps(),\n\t\t// Compile TypeScript files\n\t\tpath.extname(item.input) === '.ts' ? rollupPluginTypescript2({\n\t\t\trollupCommonJSResolveHack: true,\n\t\t\tclean: true,\n\t\t\tdeclaration: true\n\t\t}) : null,\n\t\t/*\n\t\trollupPluginTypescript2({\n\t\t\tlib: ['es5', 'es6', 'dom'],\n\t\t\ttarget: 'es5',\n\t\t\ttsconfig: false,\n\t\t}),\n\t\t*/\n\t\t// Allow bundling cjs modules (unlike webpack, rollup doesn't understand cjs)\n\t\trollupPluginCommonJs({\n\t\t\texclude: ['node_modules/**'],\n\t\t}),\n\t\t// Allow node_modules resolution, so you can use 'external' to control\n\t\t// which external modules to include in the bundle\n\t\t// https://github.com/rollup/rollup-plugin-node-resolve#usage\n\t\t// rollupPluginNodeResolve(),\n\t\t/*\n\t\trollupPluginBabel({\n\t\t\tpresets: [\n\t\t\t\t[babelPresetEnv, {\n\t\t\t\t\tmodules: false,\n\t\t\t\t\tloose: true\n\t\t\t\t}]\n\t\t\t],\n\t\t\texclude: 'node_modules/**' // only transpile our source code\n\t\t\t// babelrc: false,\n\t\t}),\n\t\t*/\n\t\trollupPluginLicense({\n\t\t\tbanner: `@license <%= pkg.name %> v<%= pkg.version %>\n\t\t\t(c) <%= moment().format('YYYY') %> <%= pkg.author %>\n\t\t\tLicense: <%= pkg.license %>`,\n\t\t}),\n\t].filter(x => x);\n\tconst input = {\n\t\tinput: item.input,\n\t\tplugins: plugins,\n\t\texternal: item.external || [],\n\t\t/*\n\t\texternal: ['tslib'],\n\t\twatch: {\n\t\t\tinclude: watchGlob,\n\t\t},\n\t\t*/\n\t};\n\treturn input;\n}\n\nfunction typescriptOutput(item) {\n\tconst input = item.input;\n\tconst output = item.output;\n\tconst outputs = Array.isArray(output) ? output : [output];\n\tconst default_ = {\n\t\tformat: 'iife',\n\t\tname: item.name || null,\n\t\tglobals: item.globals || {},\n\t\tsourcemap: true,\n\t\tminify: item.minify || false,\n\t};\n\treturn outputs.map(x => {\n\t\tlet output = Object.assign({}, default_);\n\t\tif (typeof x === 'string') {\n\t\t\toutput.file = x;\n\t\t} else if (typeof x === 'object') {\n\t\t\toutput = Object.assign(output, x);\n\t\t}\n\t\toutput.name = output.name || path.basename(output.file, '.js');\n\t\t/*\n\t\tconst plugins = [\n\t\t\tpath.extname(input) === '.ts' ? rollupPluginTypescript2({\n\t\t\t\ttarget: output.format === 'es' ? 'ESNext' : 'ES5',\n\t\t\t\tmodule: output.format === 'es' ? 'ES6' : 'ES5',\n\t\t\t\tmoduleResolution: output.format === 'iife' ? 'classic' : 'node',\n\t\t\t\tdeclaration: true\n\t\t\t}) : null,\n\t\t].filter(x => x);\n\t\toutput.plugins = plugins;\n\t\t*/\n\t\treturn output;\n\t});\n}\n\nmodule.exports = {\n\ttypescript: typescript_,\n\ttypescriptInput,\n\ttypescriptOutput,\n};\n","const cssnano = require('cssnano'),\n\tgulpAutoprefixer = require('gulp-autoprefixer'),\n\tgulpConnect = require('gulp-connect'),\n\tgulpFilter = require('gulp-filter'),\n\tgulpHtmlExtend = require('gulp-html-extend'),\n\tgulpHtmlMin = require('gulp-htmlmin'),\n\tgulpIf = require('gulp-if'),\n\tgulpPlumber = require('gulp-plumber'),\n\tgulpPostcss = require('gulp-postcss'),\n\tgulpRename = require('gulp-rename'),\n\tgulpTerser = require('gulp-terser'),\n\tpath = require('path');\n\nconst { dest, parallel, series, src, watch } = require('gulp');\n\nconst { setEntry } = require('../watch/watch');\n\nconst log = require('../logger/logger');\nconst { service } = require('../config/config');\nconst tfsCheckout = require('../tfs/tfs');\nconst { sass } = require('./sass');\n\nconst { rollup, rollupInput, rollupOutput } = require('./rollup');\nconst { typescript, typescriptInput, typescriptOutput } = require('./typescript');\n\nfunction compile(item, ext, done) {\n\t// console.log('compile', ext, item);\n\tlet task;\n\tswitch (ext) {\n\t\tcase '.scss':\n\t\t\ttask = compileScssItem(item);\n\t\t\tbreak;\n\t\tcase '.js':\n\t\t\ttask = compileJsItem(item);\n\t\t\tbreak;\n\t\tcase '.ts':\n\t\t\ttask = compileTsItem(item);\n\t\t\tbreak;\n\t\tcase '.html':\n\t\t\ttask = compileHtmlItem(item);\n\t\t\tbreak;\n\t}\n\treturn task ? task : (typeof done === 'function' ? done() : null);\n}\n\nfunction compileScss(done) {\n\tconst items = compiles('.scss');\n\tconst tasks = items.map(item => function itemTask() {\n\t\treturn compileScssItem(item);\n\t});\n\treturn tasks.length ? parallel(...tasks)(done) : done();\n}\n\nfunction compileScssItem(item) {\n\treturn src(item.input, { base: '.', allowEmpty: true, sourcemaps: true })\n\t\t.pipe(gulpPlumber())\n\t\t.pipe(sass({\n\t\t\tincludePaths: ['./node_modules/', __dirname + '/node_modules', 'node_modules'],\n\t\t}).on('compile:scss.error', (error) => {\n\t\t\tlog.error('compile:scss', error);\n\t\t}))\n\t\t.pipe(gulpAutoprefixer())\n\t\t.pipe(gulpRename(item.output))\n\t\t.pipe(tfsCheckout())\n\t\t.pipe(dest('.', item.minify ? null : { sourcemaps: '.' }))\n\t\t.pipe(gulpFilter('**/*.css'))\n\t\t.on('end', () => log('Compile', item.output))\n\t\t.pipe(gulpIf(item.minify, gulpPostcss([\n\t\t\t// gulpAutoprefixer({browsers: ['last 1 version']}),\n\t\t\tcssnano()\n\t\t])))\n\t\t.pipe(gulpIf(item.minify, gulpRename({ extname: '.min.css' })))\n\t\t.pipe(tfsCheckout(!item.minify))\n\t\t.pipe(gulpIf(item.minify, dest('.', { sourcemaps: '.' })))\n\t\t.pipe(gulpFilter('**/*.css'))\n\t\t.pipe(gulpConnect.reload());\n}\n\nfunction compileJs(done) {\n\tconst items = compiles('.js');\n\tconst tasks = items.map(item => function itemTask(done) {\n\t\treturn compileJsItem(item, done);\n\t});\n\treturn tasks.length ? parallel(...tasks)(done) : done();\n}\n\nfunction compileJsItem(item, done) {\n\tconst tasks = [];\n\tconst outputs = rollupOutput(item);\n\toutputs.forEach((output, i) => {\n\t\t// console.log(output);\n\t\ttasks.push(function itemTask(done) {\n\t\t\tconst item_ = Object.assign({}, item, { output });\n\t\t\t// console.log('item_', item_);\n\t\t\treturn compileRollup(item_);\n\t\t});\n\t});\n\treturn tasks.length ? series(...tasks)(done) : done();\n}\n\nfunction compileTs(done) {\n\tconst items = compiles('.ts');\n\tconst tasks = items.map(item => function itemTask(done) {\n\t\treturn compileTsItem(item, done);\n\t});\n\treturn tasks.length ? parallel(...tasks)(done) : done();\n}\n\nfunction compileTsItem(item, done) {\n\tconst tasks = [];\n\tconst outputs = typescriptOutput(item);\n\toutputs.forEach((output, i) => {\n\t\t// console.log(output);\n\t\ttasks.push(function itemTask(done) {\n\t\t\tconst item_ = Object.assign({}, item, { output });\n\t\t\t// console.log('item_', item_);\n\t\t\tconst output_ = typescriptOutput(item_)[0];\n\t\t\tswitch (output_.format) {\n\t\t\t\tcase 'iife':\n\t\t\t\tcase 'umd':\n\t\t\t\t\treturn compileRollup(item_);\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\treturn compileTypescript(item_);\n\t\t\t}\n\t\t\t/*\n\t\t\t'iife': 'iife', // A self-executing function, suitable for inclusion as a <script> tag. (If you want to create a bundle for your application, you probably want to use this.)\n\t\t\t'umd': 'umd', // Universal Module Definition, works as amd, cjs and iife all in one\n\t\t\t'amd': 'amd', // Asynchronous Module Definition, used with module loaders like RequireJS\n\t\t\t'cjs': 'cjs', // CommonJS, suitable for Node and other bundlers\n\t\t\t'esm': 'esm', // Keep the bundle as an ES module file, suitable for other bundlers and inclusion as a <script type=module> tag in modern browsers\n\t\t\t'system': 'system', // Native format of the SystemJS loader\n\t\t\t*/\n\t\t\treturn compileTypescript(item_);\n\t\t});\n\t});\n\treturn tasks.length ? series(...tasks)(done) : done();\n}\n\nfunction compileHtml(done) {\n\tconst items = compiles('.html');\n\tconst tasks = items.map(item => function itemTask() {\n\t\treturn compileHtmlItem(item);\n\t});\n\treturn tasks.length ? parallel(...tasks)(done) : done();\n}\n\nfunction compileHtmlItem(item) {\n\tsetEntry(item.input, path.extname(item.input));\n\treturn src(item.input, { base: '.', allowEmpty: true, sourcemaps: true })\n\t\t.pipe(gulpPlumber())\n\t\t.pipe(gulpHtmlExtend({ annotations: true, verbose: false }))\n\t\t.pipe(gulpIf(item.minify, gulpHtmlMin({ collapseWhitespace: true })))\n\t\t.pipe(gulpRename(function(path) {\n\t\t\treturn {\n\t\t\t\tdirname: item.output,\n\t\t\t\tbasename: path.basename,\n\t\t\t\textname: path.extname,\n\t\t\t};\n\t\t}))\n\t\t.pipe(tfsCheckout())\n\t\t.pipe(dest('.'))\n\t\t.on('end', () => log('Compile', item.output))\n\t\t.pipe(gulpConnect.reload());\n}\n\nfunction compileRollup(item) {\n\tconst outputs = rollupOutput(item);\n\tconst minify = item.minify;\n\treturn src(item.input, { base: '.', allowEmpty: true, sourcemaps: true })\n\t\t.pipe(gulpPlumber())\n\t\t.pipe(rollup(item))\n\t\t/*\n\t\t.pipe(gulpRename(function(file) {\n\t\t\tconst output = outputs.find(x => {\n\t\t\t\t// console.log('file', x.file, file.basename, x.file.indexOf(file.basename));\n\t\t\t\treturn x.file.indexOf(file.basename) !== -1;\n\t\t\t});\n\t\t\tfile.dirname = path.dirname(output.file);\n\t\t}))\n\t\t*/\n\t\t.pipe(tfsCheckout())\n\t\t.pipe(dest('.', minify ? null : { sourcemaps: '.' }))\n\t\t.pipe(gulpFilter('**/*.js'))\n\t\t.on('end', () => log('Compile', outputs.map(x => x.file).join(', ')))\n\t\t.pipe(gulpIf(minify, gulpTerser()))\n\t\t.pipe(gulpIf(minify, gulpRename({ extname: '.min.js' })))\n\t\t.pipe(tfsCheckout(!minify))\n\t\t.pipe(gulpIf(minify, dest('.', { sourcemaps: '.' })))\n\t\t.pipe(gulpFilter('**/*.js'))\n\t\t.pipe(gulpConnect.reload());\n}\n\nfunction compileTypescript(item) {\n\tconst outputs = typescriptOutput(item);\n\tconst minify = outputs[0].minify;\n\treturn src(item.input, { base: '.', allowEmpty: true, sourcemaps: true })\n\t\t.pipe(gulpPlumber())\n\t\t.pipe(typescript(item))\n\t\t/*\n\t\t// .pipe(gulpRename(item.output))\n\t\t.pipe(tfsCheckout())\n\t\t.pipe(dest('.', minify ? null : { sourcemaps: '.' }))\n\t\t*/\n\t\t.pipe(gulpFilter('**/*.js'))\n\t\t.on('end', () => log('Compile', outputs.map(x => x.file).join(', ')))\n\t\t/*\n\t\t.pipe(gulpIf(minify, gulpTerser()))\n\t\t.pipe(gulpIf(minify, gulpRename({ extname: '.min.js' })))\n\t\t.pipe(tfsCheckout(!minify))\n\t\t.pipe(gulpIf(minify, dest('.', { sourcemaps: '.' })))\n\t\t*/\n\t\t.pipe(gulpFilter('**/*.js'))\n\t\t.pipe(gulpConnect.reload());\n}\n\n/*\nfunction compileWatcher() {\n\tconst scss = watch(globs('.scss'), function compileScss_(done) {\n\t\tcompileScss(done);\n\t}).on('change', logWatch);\n\tconst js = watch(globs('.js'), function compileJs_(done) {\n\t\tcompileJs(done);\n\t}).on('change', logWatch);\n\tconst ts = watch(globs('.ts'), function compileTs_(done) {\n\t\tcompileTs(done);\n\t}).on('change', logWatch);\n\tconst html = watch(globs('.html'), function compileHtml_(done) {\n\t\tcompileHtml(done);\n\t}).on('change', logWatch);\n\treturn [scss, js, ts, html];\n}\n\nfunction compileCssWatcher() {\n\tconst scss = watch(globs('.scss'), function compileScss_(done) {\n\t\tcompileScss(done);\n\t}).on('change', logWatch);\n\treturn [scss];\n}\n\nfunction compileJsWatcher() {\n\tconst js = watch(globs('.js'), function compileJs_(done) {\n\t\tcompileJs(done);\n\t}).on('change', logWatch);\n\tconst ts = watch(globs('.ts'), function compileTs_(done) {\n\t\tcompileTs(done);\n\t}).on('change', logWatch);\n\treturn [js, ts];\n}\n\nfunction logWatch(path, stats) {\n\tlog('Changed', path);\n}\n*/\n\nfunction compiles(ext) {\n\tif (service.config) {\n\t\treturn service.config.compile.filter((item) => {\n\t\t\treturn new RegExp(`${ext}$`).test(item.input);\n\t\t});\n\t} else {\n\t\treturn [];\n\t}\n}\n\nfunction globs(ext) {\n\treturn compiles(ext).map(x => {\n\t\treturn x.input.replace(/\\/[^\\/]*$/, '/**/*' + ext);\n\t});\n}\n\nmodule.exports = {\n\tcompile,\n\tcompileScss,\n\tcompileScssItem,\n\tcompileJs,\n\tcompileJsItem,\n\tcompileTs,\n\tcompileTsItem,\n\tcompileHtml,\n};\n","const cssnano = require('cssnano'),\n\tgulpFilter = require('gulp-filter'),\n\tgulpIf = require('gulp-if'),\n\tgulpPlumber = require('gulp-plumber'),\n\tgulpPostcss = require('gulp-postcss'),\n\tgulpRename = require('gulp-rename'),\n\tgulpTerser = require('gulp-terser'),\n\tgulpConcat = require('gulp-concat');\n\nconst { dest, parallel, src, watch } = require('gulp');\n\nconst log = require('../logger/logger');\nconst { service } = require('../config/config');\nconst tfsCheckout = require('../tfs/tfs');\nconst { setEntry } = require('../watch/watch');\n\nfunction bundle(item, ext, done) {\n\t// console.log('bundle', ext, item);\n\tlet task;\n\tswitch (ext) {\n\t\tcase '.scss':\n\t\t\ttask = bundleCssItem(item);\n\t\t\tbreak;\n\t\tcase '.js':\n\t\t\ttask = bundleJsItem(item);\n\t\t\tbreak;\n\t}\n\treturn task ? task : (typeof done === 'function' ? done() : null);\n}\n\n// BUNDLE CSS\nfunction bundleCss(done) {\n\tconst items = bundles('.css');\n\tconst tasks = items.map(item => function itemTask(done) {\n\t\tsetEntry(item.output, Array.isArray(item.input) ? item.input : [item.input]);\n\t\treturn bundleCssItem(item);\n\t});\n\treturn tasks.length ? parallel(...tasks)(done) : done();\n}\n\nfunction bundleCssItem(item) {\n\tconst skip = item.input.length === 1 && item.input[0] === item.output;\n\tconst plugins = [\n\t\t// autoprefixer({browsers: ['last 1 version']}),\n\t\tcssnano()\n\t];\n\treturn src(item.input, { base: '.', allowEmpty: true, sourcemaps: true })\n\t\t.pipe(gulpPlumber())\n\t\t.pipe(gulpIf(!skip, gulpConcat(item.output)))\n\t\t.pipe(tfsCheckout(skip))\n\t\t.pipe(gulpIf(!skip, dest('.')))\n\t\t.on('end', () => log('Bundle', item.output))\n\t\t.pipe(gulpIf(item.minify, gulpPostcss(plugins)))\n\t\t.pipe(gulpIf(item.minify, gulpRename({ extname: '.min.css' })))\n\t\t.pipe(tfsCheckout(!item.minify))\n\t\t.pipe(gulpIf(item.minify, dest('.', { sourcemaps: '.' })))\n\t\t.pipe(gulpFilter('**/*.css'));\n}\n\n// BUNDLE JS\nfunction bundleJs(done) {\n\t// console.log('service', service, service.config.bundle[0]);\n\tconst items = bundles('.js');\n\tconst tasks = items.map(item => function itemTask(done) {\n\t\tsetEntry(item.output, Array.isArray(item.input) ? item.input : [item.input]);\n\t\treturn bundleJsItem(item);\n\t});\n\treturn tasks.length ? parallel(...tasks)(done) : done();\n}\n\nfunction bundleJsItem(item) {\n\tconst skip = item.input.length === 1 && item.input[0] === item.output;\n\treturn src(item.input, { base: '.', allowEmpty: true, sourcemaps: true })\n\t\t.pipe(gulpPlumber())\n\t\t.pipe(gulpIf(!skip, gulpConcat(item.output)))\n\t\t.pipe(tfsCheckout(skip))\n\t\t.pipe(gulpIf(!skip, dest('.')))\n\t\t.on('end', () => log('Bundle', item.output))\n\t\t.pipe(gulpIf(item.minify, gulpTerser()))\n\t\t.pipe(gulpIf(item.minify, gulpRename({ extname: '.min.js' })))\n\t\t.pipe(tfsCheckout(!item.minify))\n\t\t.pipe(gulpIf(item.minify, dest('.', { sourcemaps: '.' })))\n\t\t.pipe(gulpFilter('**/*.js'));\n}\n\n/*\nfunction bundleWatcher(config) {\n\tconst css = bundles('.css').map((item) => {\n\t\treturn watch(item.input, function bundleCss_(done) {\n\t\t\treturn bundleCssItem(item);\n\t\t}).on('change', logWatch);\n\t});\n\tconst js = bundles('.js').map((item) => {\n\t\treturn watch(item.input, function bundleJs_(done) {\n\t\t\treturn bundleJsItem(item);\n\t\t}).on('change', logWatch);\n\t});\n\treturn [css, js];\n}\n\nfunction bundleCssWatcher(config) {\n\tconst css = bundles('.css').map((item) => {\n\t\treturn watch(item.input, function bundleCss_(done) {\n\t\t\treturn bundleCssItem(item);\n\t\t}).on('change', logWatch);\n\t});\n\treturn [css];\n}\n\nfunction bundleJsWatcher(config) {\n\tconst js = bundles('.js').map((item) => {\n\t\treturn watch(item.input, function bundleJs_(done) {\n\t\t\treturn bundleJsItem(item);\n\t\t}).on('change', logWatch);\n\t});\n\treturn [js];\n}\n\nfunction logWatch(path, stats) {\n\tlog('Changed', path);\n}\n*/\n\nfunction bundles(ext) {\n\tif (service.config) {\n\t\treturn service.config.bundle.filter((item) => {\n\t\t\treturn new RegExp(`${ext}$`).test(item.output);\n\t\t});\n\t} else {\n\t\treturn [];\n\t}\n}\n\nmodule.exports = {\n\tbundle,\n\tbundleCss,\n\tbundleCssItem,\n\tbundleJs,\n\tbundleJsItem,\n\tbundles,\n};\n","const gulpIf = require('gulp-if'),\n\tgulpPlumber = require('gulp-plumber'),\n\tgulpRename = require('gulp-rename');\n\nconst { dest, parallel, src, watch } = require('gulp');\n\nconst log = require('../logger/logger');\nconst { service } = require('../config/config');\nconst tfsCheckout = require('../tfs/tfs');\nconst { setEntry } = require('../watch/watch');\n\nfunction copy(item, ext, done) {\n\t// console.log('copy', ext, item);\n\tlet task;\n\tswitch (ext) {\n\t\tdefault:\n\t\t\ttask = copyItemTask(item);\n\t}\n\treturn task ? task : (typeof done === 'function' ? done() : null);\n}\n\nfunction copyTask(done) {\n\tconst items = copies(service.config);\n\tconst tasks = items.map(item => function itemTask(done) {\n\t\treturn copyItemTask(item);\n\t});\n\treturn tasks.length ? parallel(...tasks)(done) : done();\n}\n\nfunction copyItemTask(item) {\n\tconst skip = item.input.length === 1 && item.input[0] === item.output;\n\treturn src(item.input, { base: '.', allowEmpty: true, sourcemaps: false })\n\t\t.pipe(gulpPlumber())\n\t\t.pipe(gulpRename({ dirname: item.output }))\n\t\t.pipe(gulpIf(!skip, dest('.')))\n\t\t.pipe(tfsCheckout(skip))\n\t\t.on('end', () => log('Bundle', item.output));\n}\n\nfunction copies() {\n\tif (service.config) {\n\t\treturn service.config.copy || [];\n\t} else {\n\t\treturn [];\n\t}\n}\n\nmodule.exports = {\n\tcopy,\n\tcopyTask,\n\tcopyItemTask,\n\tcopies,\n};\n","const gulpConnect = require('gulp-connect'),\n\turl = require('url');\n\nconst log = require('../logger/logger');\nconst { service } = require('../config/config');\n\n// SERVE\nfunction serve(done) {\n\tif (service.config.server) {\n\t\tconst options = Object.assign({\n\t\t\tname: 'Development',\n\t\t\troot: './docs',\n\t\t\tport: 8001,\n\t\t\thost: 'localhost',\n\t\t\thttps: false,\n\t\t\tpath: '/',\n\t\t\tlivereload: true,\n\t\t}, service.config.server || {});\n\t\toptions.fallback = `${options.path}index.html`;\n\t\tconst middleware = middleware_({\n\t\t\tlogger: options.log ? log : undefined,\n\t\t\trewrites: [{\n\t\t\t\tfrom: new RegExp(`^${options.path}.*$`),\n\t\t\t\tto: (context) => {\n\t\t\t\t\treturn context.parsedUrl.pathname.replace(options.path, '/');\n\t\t\t\t}\n\t\t\t}]\n\t\t});\n\t\toptions.middleware = (connect, opt) => {\n\t\t\treturn [middleware];\n\t\t};\n\t\tgulpConnect.server(options, function() {\n\t\t\tthis.server.on('close', done);\n\t\t});\n\t} else {\n\t\tdone();\n\t}\n}\n\nfunction middleware_(options) {\n\toptions = options || {};\n\tconst logger = getLogger(options);\n\treturn function(req, res, next) {\n\t\tconst headers = req.headers;\n\t\tif (!headers || typeof headers.accept !== 'string') {\n\t\t\tlogger(\n\t\t\t\t'Not rewriting',\n\t\t\t\treq.method,\n\t\t\t\treq.url,\n\t\t\t\t'because the client did not send an HTTP accept header.'\n\t\t\t);\n\t\t\treturn next();\n\t\t} else if (headers.accept.indexOf('application/json') === 0) {\n\t\t\tif (req.url.indexOf('.json') !== -1) {\n\t\t\t\treq.method = 'GET';\n\t\t\t}\n\t\t\t/*\n\t\t\tlogger(\n\t\t\t\t'Not rewriting',\n\t\t\t\treq.method,\n\t\t\t\treq.url,\n\t\t\t\t'because the client prefers JSON.'\n\t\t\t);\n\t\t\treturn next();\n\t\t\t*/\n\t\t} else if (req.method !== 'GET') {\n\t\t\tlogger(\n\t\t\t\t'Not rewriting',\n\t\t\t\treq.method,\n\t\t\t\treq.url,\n\t\t\t\t'because the method is not GET.'\n\t\t\t);\n\t\t\treturn next();\n\t\t} else if (!acceptsHtml(headers.accept, options)) {\n\t\t\tlogger(\n\t\t\t\t'Not rewriting',\n\t\t\t\treq.method,\n\t\t\t\treq.url,\n\t\t\t\t'because the client does not accept HTML.'\n\t\t\t);\n\t\t\treturn next();\n\t\t}\n\t\tconst parsedUrl = url.parse(req.url);\n\t\tlet rewriteTarget;\n\t\toptions.rewrites = options.rewrites || [];\n\t\tfor (let i = 0; i < options.rewrites.length; i++) {\n\t\t\tconst rewrite = options.rewrites[i];\n\t\t\tconst match = parsedUrl.pathname.match(rewrite.from);\n\t\t\tif (match !== null) {\n\t\t\t\trewriteTarget = evaluateRewriteRule(parsedUrl, match, rewrite.to, req);\n\t\t\t\tif (rewriteTarget.charAt(0) !== '/') {\n\t\t\t\t\tlogger(\n\t\t\t\t\t\t'We recommend using an absolute path for the rewrite target.',\n\t\t\t\t\t\t'Received a non-absolute rewrite target',\n\t\t\t\t\t\trewriteTarget,\n\t\t\t\t\t\t'for URL',\n\t\t\t\t\t\treq.url\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tlogger('Rewriting', req.method, req.url, 'to', rewriteTarget);\n\t\t\t\treq.url = rewriteTarget;\n\t\t\t\treturn next();\n\t\t\t}\n\t\t}\n\t\tconst pathname = parsedUrl.pathname;\n\t\tif (pathname.lastIndexOf('.') > pathname.lastIndexOf('/') &&\n\t\t\toptions.disableDotRule !== true) {\n\t\t\tlogger(\n\t\t\t\t'Not rewriting',\n\t\t\t\treq.method,\n\t\t\t\treq.url,\n\t\t\t\t'because the path includes a dot (.) character.'\n\t\t\t);\n\t\t\treturn next();\n\t\t}\n\t\trewriteTarget = options.index || '/index.html';\n\t\tlogger('Rewriting', req.method, req.url, 'to', rewriteTarget);\n\t\treq.url = rewriteTarget;\n\t\tnext();\n\t};\n};\n\nfunction evaluateRewriteRule(parsedUrl, match, rule, req) {\n\tif (typeof rule === 'string') {\n\t\treturn rule;\n\t} else if (typeof rule !== 'function') {\n\t\tthrow new Error('Rewrite rule can only be of type string or function.');\n\t}\n\treturn rule({\n\t\tparsedUrl: parsedUrl,\n\t\tmatch: match,\n\t\trequest: req\n\t});\n}\n\nfunction acceptsHtml(header, options) {\n\toptions.htmlAcceptHeaders = options.htmlAcceptHeaders || ['text/html', '*/*'];\n\tfor (let i = 0; i < options.htmlAcceptHeaders.length; i++) {\n\t\tif (header.indexOf(options.htmlAcceptHeaders[i]) !== -1) {\n\t\t\treturn true;\n\t\t}\n\t}\n\treturn false;\n}\n\nfunction getLogger(options) {\n\tif (options && options.logger) {\n\t\treturn options.logger;\n\t} else if (options && options.verbose) {\n\t\t// eslint-disable-next-line no-console\n\t\treturn console.log.bind(console);\n\t}\n\treturn function() {};\n}\n\nmodule.exports = {\n\tserve,\n};\n","const path = require('path');\nconst { parallel, series } = require('gulp');\nconst { compile, compileScss, compileJs, compileTs, compileHtml } = require('./compile/compile');\nconst { bundle, bundleCss, bundleJs } = require('./bundle/bundle');\nconst { copy, copyTask } = require('./copy/copy');\nconst { serve } = require('./serve/serve');\nconst { watchEntries, setEntry } = require('./watch/watch');\n\nconst log = require('./logger/logger');\nconst { CONFIG_PATH, getConfig } = require('./config/config');\nlet config = getConfig();\n\nconst compileTask = parallel(compileScss, compileJs, compileTs, compileHtml); // compilePartials, compileSnippets\n\nconst compileCssTask = parallel(compileScss);\n\nconst compileJsTask = parallel(compileJs, compileTs);\n\nconst bundleTask = parallel(bundleCss, bundleJs);\n\nfunction watchTask(done, filters) {\n\tsetEntry(CONFIG_PATH, CONFIG_PATH);\n\twatchEntries((path_, entry, done) => {\n\t\tif (entry === CONFIG_PATH) {\n\t\t\tconfig = getConfig();\n\t\t\treturn series(compileTask, bundleTask, copyTask)(done);\n\t\t}\n\t\tconfig.target.compile.forEach(x => {\n\t\t\t// console.log(entry, x.input);\n\t\t\tif (entry.indexOf(x.input) !== -1) {\n\t\t\t\tconst ext = path.extname(entry);\n\t\t\t\tif (!filters || filters.indexOf(ext) !== -1) {\n\t\t\t\t\tlog('Watch', path_, '>', entry);\n\t\t\t\t\t// console.log('compile', ext, x);\n\t\t\t\t\tcompile(x, ext, done);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tconfig.target.bundle.forEach(x => {\n\t\t\tconst inputs = Array.isArray(x.input) ? x.input : [x.input];\n\t\t\tconst item = inputs.find(x => path_.indexOf(x) !== -1);\n\t\t\tif (item) {\n\t\t\t\tconst ext = path.extname(entry);\n\t\t\t\tif (!filters || filters.indexOf(ext) !== -1) {\n\t\t\t\t\tlog('Watch', path_, '>', entry);\n\t\t\t\t\t// console.log('bundle', ext, x);\n\t\t\t\t\tbundle(x, ext, done);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\t/*\n\t\tconfig.target.copy.forEach(x => {\n\t\t\tconst inputs = Array.isArray(x.input) ? x.input : [x.input];\n\t\t\tconst item = inputs.find(x => path_.indexOf(x) !== -1);\n\t\t\tif (item) {\n\t\t\t\tconst ext = path.extname(entry);\n\t\t\t\tif (!filters || filters.indexOf(ext) !== -1) {\n\t\t\t\t\tlog('Watch', path_, '>', entry);\n\t\t\t\t\t// console.log('copy', ext, x);\n\t\t\t\t\tcopy(x, ext, done);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\t*/\n\t});\n\tdone();\n}\n\nfunction watchCssTask(done) {\n\treturn watchTask(node, ['.scss', '.css']);\n}\n\nfunction watchJsTask(done) {\n\treturn watchTask(node, ['.js', '.mjs', '.ts', '.tsx']);\n}\n\nexports.compile = compileTask;\nexports.bundle = series(bundleTask, copyTask);\nexports.watch = watchTask;\nexports.serve = serve;\nexports.build = series(compileTask, bundleTask, copyTask);\nexports.buildCss = series(compileCssTask, bundleCss);\nexports.buildCssAndWatch = series(compileCssTask, bundleCss, watchCssTask);\nexports.buildJs = series(compileJsTask, bundleJs);\nexports.buildJsAndWatch = series(compileJsTask, bundleJs, watchJsTask);\nexports.buildAndWatch = series(compileTask, bundleTask, copyTask, watchTask);\nexports.buildWatchAndServe = series(compileTask, bundleTask, copyTask, watchTask, serve);\n\n/*\nlet watchers = [];\n\nfunction watchAllTask(done) {\n\twhile (watchers.length) {\n\t\tconst w = watchers.shift();\n\t\tif (typeof w.close === 'function') {\n\t\t\tw.close();\n\t\t}\n\t}\n\tconst compileWatcherTask = compileWatcher(config);\n\tconst bundleWatcherTask = bundleWatcher(config);\n\tconst configWatcherTask = configWatcher(function(done) {\n\t\tconfig = getConfig();\n\t\treturn series(compileTask, bundleTask, copyTask, watchTask)(done);\n\t});\n\twatchers = [].concat(compileWatcherTask, bundleWatcherTask, configWatcherTask);\n\tdone();\n}\n\nfunction watchCssTask(done) {\n\twhile (watchers.length) {\n\t\tconst w = watchers.shift();\n\t\tif (typeof w.close === 'function') {\n\t\t\tw.close();\n\t\t}\n\t}\n\tconst compileCssWatcherTask = compileCssWatcher(config);\n\tconst bundleCssWatcherTask = bundleCssWatcher(config);\n\tconst configWatcherTask = configWatcher(function(done) {\n\t\treturn series(compileCssTask, bundleCss, watchCssTask)(done);\n\t});\n\twatchers = [].concat(compileCssWatcherTask, bundleCssWatcherTask, configWatcherTask);\n\tdone();\n}\n\nfunction watchJsTask(done) {\n\twhile (watchers.length) {\n\t\tconst w = watchers.shift();\n\t\tif (typeof w.close === 'function') {\n\t\t\tw.close();\n\t\t}\n\t}\n\tconst compileJsWatcherSubTask = compileJsWatcher(config);\n\tconst bJsWatcher = bundleJsWatcher(config);\n\tconst configWatcherTask = configWatcher(function(done) {\n\t\treturn series(compileJsTask, bundleJs, watchTask)(done);\n\t});\n\twatchers = [].concat(compileJsWatcherSubTask, bJsWatcher, configWatcherTask);\n\tdone();\n}\n*/\n"],"names":["consoleConsole","require$$0","Console","nodeVersion","parseNodeVersion","process","version","colorDetectionOptions","ignoreTTY","platform","console","major","stdout","stderr","colorMode","palette","Reset","Bright","Dim","Underscore","Blink","Reverse","Hidden","FgBlack","FgRed","FgGreen","FgYellow","FgBlue","FgMagenta","FgCyan","FgWhite","BgBlack","BgRed","BgGreen","BgYellow","BgBlue","BgMagenta","BgCyan","BgWhite","colors","hasFlag","flag","argv","indexOf","addColor","str","ansyGray","colorSupport","getTimestamp","timeStamp","getLogMessage","items","a","Array","from","concat","apply","map","x","i","length","push","getErrorMessage","log","time","write","arguments","info","dir","warn","error","watch","entries","cwd","setEntry","entry","imports","replace","isArray","watcher","watchEntries","callback","close","complete","done","on","path_","Object","keys","reduce","p","key","isGlob","isExt","sameRoot","isPath","found","find","path","p1","ext","extname","p2","dirname","getObject","file","objectDefault","objectOverride","object","extendObject","fs","existsSync","text","readFileSync","objectJson","JSON","parse","stripBom","toString","charCodeAt","slice","b","extend","require$$1","CONFIG_PATH","options","getOptions","target","service","undefined","o","c","k","v","substr","getTarget","compile","bundle","getConfig","configDefault","targets","browser","dist","server","src","host","port","tfs","config","tfsCheckout","skip","gulpIf","through2","obj","enc","paths","responseError","response","message","sass","sync","assign","isNull","isStream","input","basename","contents","replaceExtension","data","indentedSyntax","includePaths","unshift","sourceMap","omitSourceMapUrl","sourceMapContents","filePush","sassObj","sassMap","sassMapFile","sassFileSrc","sassFileSrcPath","sourceFileIndex","relative","sources","source","index","join","filter","vinylSourcemapsApply","css","stats","includedFiles","nodeSass","render","renderSync","filePath","format","name","DEFAULT_EXTENSIONS","require$$2","rollupCache","Map","rollup_","item","inputOptions","rollupInput","cache","get","maps","originalCwd","originalPath","rollupGenerate","output","generate","then","result","newFileName","newFilePath","targetFile","newFile","vinyl","base","stat","isFile","isDirectory","isBlockDevice","isCharacterDevice","isSymbolicLink","isFIFO","isSocket","generated","Buffer","code","rollup","outputs","rollupOutput","set","Promise","all","results","forEach","modules","presetEnvOptions","loose","esmodules","tsconfigDefaults","compilerOptions","module","lib","allowJs","declaration","removeComments","exclude","tsconfigOverride","plugins","rollupPluginSourcemaps","rollupPluginCommonJs","rollupPluginTypescript2","typescript","tsconfig","rollupCommonJSResolveHack","clean","check","rollupPluginBabel","extensions","presets","comments","rollupPluginLicense","banner","external","treeshake","default_","globals","sourcemap","minify","typescript_","typescriptOutput","typescriptLib","typescriptCompile","typescriptConfig","program","createProgram","fileNames","emitResult","emit","typescriptDiagnostic","getPreEmitDiagnostics","diagnostics","exitCode","emitSkipped","configFileName","typeRoots","strict","configOverride","files","moduleResolution","experimentalDecorators","emitDecoratorMetadata","importHelpers","allowSyntheticDefaultImports","esModuleInterop","outFile","outDir","configFileText","stringify","parseConfigFileTextToJson","configObject","configParseResult","parseJsonConfigFileContent","sys","errors","diagnostic","where","getLineAndCharacterOfPosition","start","fileName","line","character","flattenDiagnosticMessageText","messageText","typescriptInput","dest","parallel","series","require$$3","require$$4","require$$5","task","compileScssItem","compileJsItem","compileTsItem","compileHtmlItem","compileScss","compiles","tasks","itemTask","allowEmpty","sourcemaps","pipe","gulpPlumber","__dirname","gulpAutoprefixer","gulpRename","gulpFilter","gulpPostcss","cssnano","gulpConnect","reload","compileJs","item_","compileRollup","compileTs","output_","compileTypescript","compileHtml","gulpHtmlExtend","annotations","verbose","gulpHtmlMin","collapseWhitespace","gulpTerser","RegExp","test","bundleCssItem","bundleJsItem","bundleCss","bundles","gulpConcat","bundleJs","copy","copyItemTask","copyTask","copies","serve","root","https","livereload","fallback","middleware","middleware_","logger","rewrites","to","context","parsedUrl","pathname","connect","opt","getLogger","req","res","next","headers","accept","method","url","acceptsHtml","rewriteTarget","rewrite","match","evaluateRewriteRule","charAt","lastIndexOf","disableDotRule","rule","Error","request","header","htmlAcceptHeaders","bind","require$$6","compileTask","compileCssTask","compileJsTask","bundleTask","watchTask","filters","inputs","watchCssTask","node","watchJsTask"],"mappings":"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"}